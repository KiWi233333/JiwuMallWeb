import{E as A}from"./divider.Dj8BMgcW.js";import{E as F}from"./tag.Q9i6oaRN.js";import{_ as Z}from"./ElImage.H3VTC2Vd.js";import{_ as q}from"./nuxt-link.eZ5kOSgI.js";import{E as G}from"./empty.TrNGK8ww.js";import{E as H}from"./scrollbar.ylZGouLy.js";import{aa as J,w as K,B as O,S as Q,f as W}from"./entry.HuYbGiLS.js";import{b as X}from"./post.vbJ-6447.js";import{j as Y,a as c,r as ee,k as D,as as te,ao as ae,L as r,M as f,N as l,a4 as E,a3 as g,Z as x,a0 as k,a9 as oe,_ as se,ar as re,a5 as S,a2 as le,a6 as B,u as h,am as ne,an as ie}from"./swiper-vue.4ZhlhtKr.js";import"./PreLoading.vue.RcEKquDI.js";import"./debounce.4-I_Xkye.js";import"./fetch.3IR0ILJ_.js";const L=n=>(ne("data-v-a390a5c5"),n=n(),ie(),n),ce={group:"","h-full":"","p-4":"","card-default":"","md:p-6":""},ue=L(()=>l("i",{"i-solar:fire-bold":"",class:"ml-2 p-0.5em text-[var(--el-color-danger)]"},null,-1)),me={class:"grid"},de={class:"flex items-center gap-3 transition-200 hover:text-[var(--el-color-info)]"},pe={class:"w-12rem flex-1 truncate"},_e={"ml-a":"","w-6rem":"",flex:"","items-center":"","justify-end":"","gap-1":"",truncate:""},ve=L(()=>l("i",{"i-solar:fire-line-duotone":"",class:"scale-0 p-0.5em transition-200 transition-transform group-hover:scale-100"},null,-1)),fe={key:0,class:"block h-0 w-0 overflow-hidden py-0 opacity-0 transition-200 transition-all group-hover:h-6rem group-hover:w-full group-hover:py-2 group-hover:op-100"},ge=Y({__name:"Rank",props:{dto:{default:()=>({})},limit:{},class:{default:""},title:{default:"热门帖子"},immediate:{type:Boolean,default:!1}},async setup(n,{expose:z}){let C,b;const t=n,i=c(!1),o=c([]),u=c(0),P=c(t.limit||10),e=ee({total:-1,pages:-1,current:-1}),T=D(()=>(e==null?void 0:e.total)===0&&e.pages===0),U=D(()=>e.pages>0&&(u.value>=e.pages||t.limit!==void 0&&t.limit<=o.value.length));async function y(){var w,d,p,_,v;if(i.value||U.value||T.value)return;if(t.limit!==void 0&&o.value.length>=t.limit){i.value=!1;return}i.value=!0,u.value++;const{data:a}=await X(u.value,P.value,t==null?void 0:t.dto);((w=a.value)==null?void 0:w.code)===Q.SUCCESS&&(e.total=(d=a.value)==null?void 0:d.data.total,e.current=(p=a.value)==null?void 0:p.data.current,e.pages=(_=a.value)==null?void 0:_.data.pages,o.value.push(...(v=a.value)==null?void 0:v.data.records),i.value=!1)}function I(){o.value.splice(0),e.total=-1,e.pages=-1,e.current=-1,u.value=0}const V=J(t.dto),m=c();z({clearResult:I,loadPostListPage:y,postList:o,pageInfo:e}),K(V,async()=>{m.value||i.value||(I(),await y(),m.value=setTimeout(()=>{clearTimeout(m.value),m.value=null},400))},{immediate:!0});const R=["var(--el-color-danger)","var(--el-color-danger-light-3)","var(--el-color-warning)","var(--el-color-warning-light-3)","var(--el-color-warning-light-5)"];return t.immediate&&([C,b]=te(()=>y()),await C,b()),(a,w)=>{const d=A,p=F,_=Z,v=q,j=G,M=H,$=ae("auto-animate");return r(),f("div",ce,[l("h3",null,[E(g(a.title)+" ",1),ue]),x(d,{"opacity-50":"",style:{margin:"1rem 0"}}),x(M,null,{default:k(()=>[oe((r(),f("section",me,[(r(!0),f(se,null,re(h(o),(s,N)=>(r(),S(v,{key:s.id,to:{path:`/community/post/detail/${s.id}`},class:"group pb-6"},{default:k(()=>[l("div",de,[l("h4",{style:le({color:R[N]||""})},g(N+1),5),l("span",pe,g(s.title),1),l("small",_e,[ve,E(" "+g(s.views)+" ",1),s.isEssence?(r(),S(p,{key:0,size:"small",effect:"dark",style:{padding:"0 0.2rem"},type:"warning"},{default:k(()=>[E(" 精 ")]),_:1})):B("",!0)])]),s.cover?(r(),f("div",fe,[x(_,{src:("BaseUrlImg"in a?a.BaseUrlImg:h(O))+s.cover,fit:"cover",class:"h-full w-full v-card"},null,8,["src"])])):B("",!0)]),_:2},1032,["to"]))),128)),h(o).length===0&&h(e).current>0?(r(),S(j,{key:0,description:"暂无帖子"})):B("",!0)])),[[$]])]),_:1})])}}}),De=W(ge,[["__scopeId","data-v-a390a5c5"]]);export{De as default};
