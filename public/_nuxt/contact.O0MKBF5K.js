import{b3 as s,gn as P,gD as R,u as b,S as N}from"./entry.t-rqPOs0.js";import{u as M}from"./useWs.cWBkfbdz.js";import{a as r,k as B}from"./swiper-vue.Dj7aAS3P.js";function W(t,n=10,a=null,d){return s.get("/chat/message/page",{roomId:t,pageSize:n,cursor:a},{headers:{Authorization:d}})}var J=(t=>(t[t.TEXT=1]="TEXT",t[t.RECALL=2]="RECALL",t[t.IMG=3]="IMG",t[t.FILE=4]="FILE",t[t.SOUND=5]="SOUND",t[t.VIDEO=6]="VIDEO",t[t.EMOJI=7]="EMOJI",t[t.SYSTEM=8]="SYSTEM",t[t.AI_CHAT=9]="AI_CHAT",t[t.DELETE=10]="DELETE",t))(J||{});function j(t,n){return s.post("/chat/message",{...t},{headers:{Authorization:n}})}function q(t,n,a){return s.put(`/chat/message/recall/${t}/${n}`,{},{headers:{Authorization:a}})}function K(t,n,a){return s.deleted(`/chat/message/recall/${t}/${n}`,{},{headers:{Authorization:a}})}function V(t,n){return s.put(`/chat/message/msg/read/${t}`,{},{headers:{Authorization:n}})}const Q=P("chat",()=>{const t=r(!0),n=r([]),a=r({activeTime:0,avatar:"",roomId:1,hotFlag:1,name:"",text:"",type:1,unreadCount:0,msgList:[],unreadMsgList:[],roomGroup:void 0,member:void 0});function d(e,o=[],u=[]){e&&(e.unreadCount=0),a.value=e||{activeTime:0,avatar:"",roomId:1,hotFlag:1,name:"",text:"",type:1,unreadCount:0,msgList:[],unreadMsgList:[]},o&&(a.value.msgList=o),u&&(a.value.unreadMsgList=u)}const h=r([]);function L(e){h.value=e}function I(e,o=""){const u=b();V(e,u.getToken).then(A=>{if(A.code!==N.SUCCESS)return!1;const l=n.value.find(f=>f.roomId===e);l&&(l.unreadCount=0,o&&(l.text=o));const E=M();E.wsMsgList.newMsg=E.wsMsgList.newMsg.filter(f=>f.message.roomId!==e)}).catch(()=>{})}const S=(e=10,o,u=!0,A)=>{},O=()=>{},z=r(0),F=(e,o=0)=>{},U=()=>{},w=e=>{},i=r([]);function D(e){i.value.includes(e)||i.value.push(e)}function $(e){return i.value=i.value.filter(o=>o===e)}const g=r();function p(e){g.value=e}const c=r({type:-1,data:{}});function C(e,o){c.value.type=e,c.value.data=o}const m=r("");function G(e){m.value=e}const v=r(!1);function x(e){v.value=e}const H=B({get:()=>c.value.type!==-1,set:e=>{e||C(-1)}});return{contactList:n,theContact:a,replyMsg:g,atUserList:i,theFriendOpt:c,showTheFriendPanel:H,delUserId:m,isAddNewFriend:v,isOpenContact:t,onOfflineList:h,setContact:d,setReadList:I,setGroupMember:L,setIsAddNewFriend:x,setAtUid:D,removeAtUid:$,setReplyMsg:p,setDelUserId:G,setTheFriendOpt:C,onReloadContact:S,scrollTopSize:z,saveScrollTop:U,scrollReplyMsg:F,scrollBottom:O,scrollTop:w}},{persist:{storage:R.localStorage}});function Z(t=10,n=null,a){return s.get("/chat/contact/page",{pageSize:t,cursor:n},{headers:{Authorization:a}})}var X=(t=>(t[t.GROUP=1]="GROUP",t[t.SELFT=2]="SELFT",t[t.AICHAT=3]="AICHAT",t))(X||{});function T(t,n=1,a){if(n===1)return s.get(`/chat/contact/${t}`,{},{headers:{Authorization:a}});if(n===2)return s.get(`/chat/contact/self/${t}`,{},{headers:{Authorization:a}})}export{J as M,X as R,Z as a,W as b,j as c,K as d,T as g,q as r,Q as u};
