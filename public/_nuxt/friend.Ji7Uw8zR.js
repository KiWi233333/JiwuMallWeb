import{u as A,b as Fe,s as xe,B as j,E as Q,c as Te,d as ae,e as Ie,f as O,w as Se,g as ne,S as R,h as Le,n as Ee,i as Ue,j as Be,a as Ae}from"./entry.HuYbGiLS.js";import{E as Oe}from"./tag.Q9i6oaRN.js";import{_ as G}from"./ElImage.H3VTC2Vd.js";import{_ as K}from"./AutoIncre.vue.KpzenuDu.js";import{E as X}from"./scrollbar.ylZGouLy.js";import{E as re}from"./empty.TrNGK8ww.js";import{j as T,a as m,r as Ne,k as le,ao as P,a9 as B,u as e,L as i,M as f,N as o,Z as p,x as ie,ai as oe,a0 as h,a4 as z,ab as ze,_ as D,a3 as k,a5 as U,ar as M,aa as J,a6 as Y,am as ee,an as te,b as ce,U as De,t as Me,V as ue,n as Ve,a1 as Re}from"./swiper-vue.4ZhlhtKr.js";import{g as Pe,a as de,F as x,C as q,b as je,c as Ge,d as Ke,_ as We,i as He}from"./ApplyDialog.vue.GpPMfClF.js";import{E as Ze}from"./index.S0AyQ0ue.js";/* empty css                    */import{u as N,g as qe,R as Je}from"./contact.IOrl_V-3.js";import{E as pe}from"./notification.mMgfY760.js";import{E as Qe}from"./divider.Dj8BMgcW.js";import{g as Xe}from"./index.FQQN3SR7.js";import"./PreLoading.vue.RcEKquDI.js";import"./debounce.4-I_Xkye.js";import"./dialog.jW0LsHVx.js";import"./isUndefined.IZwZ21d-.js";import"./useWs.6oZqrKhZ.js";const W=_=>(ee("data-v-6d2b0410"),_=_(),te(),_),Ye={class:"h-full w-full flex flex-col",relative:""},et={class:"v-input","flex-row-c-c":""},tt={key:0,class:"absolute left-0 top-2rem z-1 h-80vh w-full flex-1 bg-color"},st={class:"tags transform-origin-top-center scale-y-0 op-0 transition-200 transition-all group-hover:scale-y-100 group-hover:op-100",absolute:"","top-0":"","top-40px":"","z-0":"",flex:"","flex-nowrap":"","cursor-pointer":"","flex-items-center":"","overflow-hidden":"","py-1":""},ot=W(()=>o("small",{"mt-2":"","op-60":""},"历史记录：",-1)),at={"pr-0.3em":""},nt={"pt-4":""},rt=["onClick"],lt={class:"relative flex-row-c-c"},it=W(()=>o("span",{class:"g-avatar"},null,-1)),ct=W(()=>o("p",{"text-center":"","text-0.7em":"","op-70":""}," 暂无更多 ",-1)),ut=W(()=>o("i",{"i-solar:users-group-two-rounded-bold-duotone":"","p-2rem":"","op-40":""},null,-1)),dt=T({__name:"ApplySearch",emits:["submit"],setup(_,{emit:r}){const u=r,t=m(""),n=m(!1),c=m({total:0,pages:0,size:0,current:0}),d=Ne([]),v=A(),s=m(!1),C=m(0),y=m(10),g=le(()=>c.value.total>0&&d.length>=c.value.total),w=Fe("jiwu_chat_friend_user",[]);async function l(){if(!t.value)return Q.error({message:"搜索内容不能为空！"});await S(),!w.value.includes(t.value)&&w.value.length<=6?w.value.unshift(t.value.trim()):w.value.pop(),await a()}async function a(){if(g.value||s.value)return;s.value=!0,C.value++;const b=await Pe(C.value,y.value,{keyWord:t.value},v.getToken);c.value={total:b.data.total,pages:b.data.pages,size:b.data.size,current:b.data.current},d.push(...b.data.records),s.value=!1,n.value=!0}function I(){n.value=!1,t.value="",d.splice(0),c.value={total:0,pages:0,size:0,current:0}}function S(){d.splice(0),c.value={total:0,pages:0,size:0,current:0},C.value=0}function L(b){w.value.splice(w.value.indexOf(b),1)}function H(b,E){w.value.splice(E,1),w.value.push(b),t.value=b,l()}const F=m(!1),se=m();function _e(){F.value&&(clearTimeout(se.value),se.value=null),!s.value&&!t.value&&(F.value=!1)}return(b,E)=>{const me=Te,fe=ae,ve=Oe,he=Ie,ge=G,ye=K,we=X,be=re,$e=P("auto-animate"),ke=P("window-lock");return B((i(),f("div",Ye,[o("div",et,[p(me,{modelValue:e(t),"onUpdate:modelValue":E[0]||(E[0]=$=>ie(t)?t.value=$:null),modelModifiers:{trim:!0},class:"mr-2",type:"text",clearable:"",autocomplete:"off","prefix-icon":"ElIconSearch"in b?b.ElIconSearch:e(xe),minlength:"2",maxlength:"30","on-search":l,placeholder:"搜索好友",onBlur:_e,onFocus:E[1]||(E[1]=$=>F.value=!0),onKeyup:[oe(I,["esc"]),oe(l,["enter"])]},null,8,["modelValue","prefix-icon"]),p(fe,{type:"primary",class:"w-5rem text-0.6em shadow",style:{position:"relative",transition:"0.2s"},loading:e(s),"icon-class":"i-solar:magnifer-outline mr-2",onFocus:E[2]||(E[2]=$=>F.value=!0),onClick:ze(l,["self"])},{default:h(()=>[z(" 搜索 ")]),_:1},8,["loading"])]),e(F)?(i(),f("div",tt,[p(he,null,{default:h(()=>[o("div",st,[ot,(i(!0),f(D,null,M(e(w),($,Z)=>(i(),U(ve,{key:$+Z,closable:"",class:"mr-1 mt-2 transition-300",onClose:Ce=>L($),onClick:Ce=>H($,Z)},{default:h(()=>[o("span",at,k($),1)]),_:2},1032,["onClose","onClick"]))),128))])]),_:1}),B(o("span",{class:"px-2 py-5 text-0.7rem"},k(` 找到 ${e(c).total} 个匹配好友`),513),[[J,e(d).length>0]]),B(p(we,{"wrap-class":"pb-6 flex-1  pr-2 pt-2 overflow-hidden",class:"pb-6"},{default:h(()=>[p(ye,{immediate:!1,"no-more":e(g),onLoad:a},{done:h(()=>[ct]),default:h(()=>[B((i(),f("div",nt,[(i(!0),f(D,null,M(e(d),$=>(i(),f("div",{key:$.id,class:"relative mb-2 flex cursor-pointer items-center gap-4 truncate truncate p-2 px-4 filter-grayscale transition-300 transition-all active:scale-96 border-default hover:border-[var(--el-color-primary)] hover:bg-white hover:op-100 hover:shadow hover:shadow-inset hover:dark:bg-dark-9 v-card",onClick:Z=>u("submit",$)},[o("div",lt,[p(ge,{src:("BaseUrlImg"in b?b.BaseUrlImg:e(j))+$.avatar,fit:"cover",class:"h-2.2em w-2.2em flex-shrink-0 overflow-auto rounded-1/2 object-cover border-default"},null,8,["src"]),it]),o("small",null,k($.nickname||$.username),1)],8,rt))),128))])),[[$e]])]),_:1},8,["no-more"])]),_:1},512),[[J,e(n)&&e(c).current&&e(d).length>0]]),p(be,{"mt-10":"","image-size":80,description:e(d).length<=0&&e(c).current>0?"没有找到好友":"好友查找"},{image:h(()=>[ut]),_:1},8,["description"])])):Y("",!0)])),[[ke,e(n)]])}}}),pt=O(dt,[["__scopeId","data-v-6d2b0410"]]),_t={"w-full":"",flex:"","flex-col":""},mt=T({__name:"GroupList",setup(_){const r=m(!1),u=A(),t=m({cursor:null,isLast:!1,size:10,total:-1}),n=m([]);async function c(){if(r.value||t.value.isLast)return;r.value=!0;const{data:v}=await de(t.value.size,t.value.cursor,u.getToken);v.list&&n.value.push(...v.list),t.value.isLast=v.isLast,t.value.cursor=v.cursor,r.value=!1}c();const d=N();return Se(()=>d.delUserId,v=>{v&&(n.value=n.value.filter(s=>s.userId!==v),d.setDelUserId(""))},{debounce:300}),(v,s)=>{const C=K,y=Ze;return i(),U(y,{class:"w-full"},{default:h(()=>[o("div",_t,[p(C,{immediate:!0,"auto-stop":!0,"no-more":e(t).isLast,loading:e(r),onLoad:c},{default:h(()=>[(i(!0),f(D,null,M(e(n),g=>(i(),f("div",{key:g.uid},k(g.nickName)+" "+k(g.activeStatus),1))),128))]),_:1},8,["no-more","loading"])])]),_:1})}}}),ft=O(mt,[["__scopeId","data-v-d01ad81d"]]),vt={"w-full":"",flex:"","flex-col":""},ht=["onClick"],gt={class:"avatar-icon"},yt=T({__name:"FriendList",setup(_){const r=m(!1),u=A(),t=m({cursor:null,isLast:!1,size:10,total:-1}),n=m([]);async function c(){if(r.value||t.value.isLast)return;r.value=!0;const{data:s}=await de(t.value.size,t.value.cursor,u.getToken);s.list&&n.value.push(...s.list),t.value.isLast=s.isLast,t.value.cursor=s.cursor,r.value=!1}c();const d=N();ce(()=>d.isAddNewFriend,s=>{s&&!r.value&&(v(),d.isAddNewFriend=!1)});function v(){t.value.cursor=null,t.value.isLast=!1,n.value=[],c()}return(s,C)=>{const y=G,g=K,w=P("auto-animate");return B((i(),f("div",vt,[p(g,{immediate:!0,"auto-stop":!0,"no-more":e(t).isLast,loading:e(r),onLoad:c},{default:h(()=>[(i(!0),f(D,null,M(e(n),l=>(i(),f("div",{key:l.id,class:"item",onClick:a=>e(d).setTheFriendOpt(("FriendOptType"in s?s.FriendOptType:e(x)).User,{id:l.userId})},[o("div",gt,[p(y,{class:"h-full w-full overflow-hidden rounded-6px",src:("BaseUrlImg"in s?s.BaseUrlImg:e(j))+l.avatar,fit:"cover"},null,8,["src"])]),o("small",null,k(l.nickName||"未填写"),1)],8,ht))),128))]),_:1},8,["no-more","loading"])])),[[w]])}}}),wt=O(yt,[["__scopeId","data-v-33444f6d"]]),V=_=>(ee("data-v-9565384c"),_=_(),te(),_),bt={class:"relative overflow-hidden border-0 border-r-1px transition-200 transition-width border-default"},$t={class:"list"},kt={class:"py-2 hover:bg-transparent"},Ct={class:"list"},Ft=V(()=>o("small",{"op-90":""},"新的朋友",-1)),xt=V(()=>o("div",{class:"avatar-icon bg-[var(--el-color-warning)]"},[o("i",{"i-solar:user-plus-bold":"","bg-light":"","p-3":""})],-1)),Tt=V(()=>o("small",null,"新的朋友",-1)),It=[xt,Tt],St={class:"list pb-4"},Lt=V(()=>o("small",{"op-90":""},"群聊",-1)),Et={class:"list"},Ut=V(()=>o("small",{"op-90":""},"好友",-1)),Bt=T({__name:"Tabs",setup(_){m(!1);const r=N();return(u,t)=>{const n=pt,c=ft,d=wt,v=X;return i(),f("div",bt,[p(v,{"view-class":" tracking-0.1em pr-2","wrap-class":"w-full"},{default:h(()=>[De(u.$slots,"top",{},()=>[o("div",$t,[o("div",kt,[p(n,{onSubmit:t[0]||(t[0]=s=>{e(r).setTheFriendOpt(("FriendOptType"in u?u.FriendOptType:e(x)).User,s)})})])]),o("div",Ct,[Ft,o("div",{class:"item",onClick:t[1]||(t[1]=s=>e(r).setTheFriendOpt(("FriendOptType"in u?u.FriendOptType:e(x)).NewFriend,{}))},It)])],!0),o("div",St,[Lt,p(c)]),o("div",Et,[Ut,p(d)])]),_:3})])}}}),At=O(Bt,[["__scopeId","data-v-9565384c"]]),Ot=T({__name:"GroupFriend",props:{data:{}},setup(_){return(r,u)=>(i(),f("div",null,k(r.data),1))}}),Nt={"w-full":"",flex:"","flex-col":""},zt={class:"item"},Dt=["onClick"],Mt={class:"flex flex-col truncate"},Vt={"cursor-pointer":""},Rt={"cursor-pointer":""},Pt={class:"ml-a flex-row-c-c flex-shrink-0"},jt={key:1},Gt={class:"py-1rem text-center op-70"},Kt=T({__name:"ApplyList",setup(_){const r=m(!1),u=A(),t=m({cursor:null,isLast:!1,size:10,page:0,total:-1}),n=m([]);async function c(){if(r.value||t.value.isLast)return;t.value.page++,r.value=!0;const{data:s}=await je(t.value.page,t.value.size,u.getToken);s.records&&n.value.push(...s.records),t.value.isLast=!!s.isLast,t.value.page=s.current||1,r.value=!1}c();const d=N();function v(s){ne.confirm("是否同意好友申请？",{confirmButtonText:"确定",cancelButtonText:"取消",lockScroll:!1,callback:async C=>{if(C==="confirm"){const y=await Ge({applyId:s},u.getToken);if(y.code===R.SUCCESS){pe.success("已添加好友！");for(const g of n.value)g.userId&&(g.status=q.Argee);d.setIsAddNewFriend(!0)}else Q.error(y.message)}}})}return(s,C)=>{const y=G,g=Le,w=K,l=P("auto-animate");return B((i(),f("div",Nt,[p(w,{immediate:!0,"auto-stop":!0,"no-more":e(t).isLast,loading:e(r),onLoad:c},{done:h(()=>[o("div",Gt,k(e(n).length?"没有更多了":"快去认识其他人"),1)]),default:h(()=>[(i(!0),f(D,null,M(e(n),a=>{var I,S;return i(),f("div",{key:a.applyId,class:"mb-3 border-0 border-b-1px pb-3 border-default"},[o("div",zt,[o("div",{class:"avatar-icon cursor-pointer",onClick:L=>e(d).setTheFriendOpt(("FriendOptType"in s?s.FriendOptType:e(x)).User,{id:a.userId})},[p(y,{class:"h-full w-full overflow-hidden rounded-6px",src:("BaseUrlImg"in s?s.BaseUrlImg:e(j))+((I=a.user)==null?void 0:I.avatar),fit:"cover"},null,8,["src"])],8,Dt),o("div",Mt,[o("p",Vt,k(((S=a.user)==null?void 0:S.nickName)||"未填写"),1),o("small",Rt,k(a.msg||""),1)]),o("div",Pt,[a.status===("ChatApplyStatusType"in s?s.ChatApplyStatusType:e(q)).Load?(i(),U(g,{key:0,onClick:L=>v(a.applyId)},{default:h(()=>[z(" 同意 ")]),_:2},1032,["onClick"])):a.status===("ChatApplyStatusType"in s?s.ChatApplyStatusType:e(q)).Argee?(i(),f("small",jt,"已同意")):Y("",!0)])])])}),128))]),_:1},8,["no-more","loading"])])),[[l]])}}}),Wt=O(Kt,[["__scopeId","data-v-a675528d"]]),Ht={class:"relative flex flex-col"},Zt=o("h4",{class:"flex-row-bt-c border-0 border-b-1 rounded-0 p-4 border-default bg-color md:p-4"}," 新的朋友 ",-1),qt=T({__name:"NewFriend",props:{data:{}},setup(_){return(r,u)=>{const t=Wt,n=X;return i(),f("div",Ht,[Zt,p(n,{"view-class":"w-1/2 mx-a","wrap-class":"w-full flex-1 h-full"},{default:h(()=>[p(t)]),_:1})])}}}),Jt={flex:"","gap-4":""},Qt={class:"text-0.8rem leading-1.5em"},Xt={"op-60":""},Yt={"op-60":""},es=T({__name:"User",props:{data:{}},setup(_){const u=Me(_.data),t=m(!1),n=m(!1),c=m({}),d=A();async function v(l){if(t.value)return;n.value=!1,t.value=!0;const a=await Xe(l,d.getToken);a.code===R.SUCCESS&&(c.value=a.data),setTimeout(()=>{t.value=!1},400),He({uidList:[l]},d.getToken).then(I=>{const S=I.data.checkedList.find(L=>L.uid===l);n.value=S&&S.isFriend===Ue.TRUE}).catch(()=>{})}const s=N();function C(l){ne.confirm("是否删除该好友？",{confirmButtonText:"删除",cancelButtonText:"取消",lockScroll:!1,type:"warning",callback:async a=>{a==="confirm"&&((await Ke(l,d.getToken)).code===R.SUCCESS&&(pe.success("删除成功！"),s.setTheFriendOpt(x.Empty,{}),s.setDelUserId(l),s.setIsAddNewFriend(!0)),s.setIsAddNewFriend(!0))}})}const y=m(!1),g=le(()=>u.value.data.id);ce(g,l=>{l&&v(l)},{immediate:!0,deep:!0});async function w(l){if(!n.value)return;const a=await qe(l,Je.SELFT,d.getToken);if(a){if(a&&a.code!==R.SUCCESS)return Q.error(a?a.message:"没有找到对应好友！");s.setContact(a.data),Ve(()=>{Ee({path:"/chat"})})}}return(l,a)=>{const I=G,S=Qe,L=ae,H=We;return i(),f("div",ue(l.$attrs,{"h-full":"","w-full":"",flex:"","flex-1":"","flex-col":"","items-center":"","gap-1rem":"","pt-6rem":"","bg-color":""}),[o("div",Jt,[p(I,{src:("BaseUrlImg"in l?l.BaseUrlImg:e(j))+e(c).avatar,fit:"cover",class:"h-3.8rem w-3.8rem flex-shrink-0 overflow-auto object-cover shadow-sm border-default v-card"},null,8,["src"]),o("div",Qt,[o("strong",null,k(e(c).nickname),1),o("p",Xt," ID："+k(e(g))+" "+k(e(c).gender||""),1),o("p",Yt," 邮箱："+k(e(c).email||"未填写"),1)])]),p(S,{style:{margin:"2rem auto",width:"30%"}}),B(o("div",null,[e(n)?(i(),U(L,{key:0,"icon-class":"i-solar:trash-bin-trash-bold-duotone p-2 mr-2",class:"op-80",type:"danger",plain:"",onClick:a[0]||(a[0]=F=>C(e(g)))},{default:h(()=>[z(" 删除好友  ")]),_:1})):Y("",!0),e(n)?(i(),U(L,{key:1,"icon-class":"i-solar:chat-line-line-duotone p-2 mr-2",class:"border-default",type:"info",onClick:a[1]||(a[1]=F=>w(e(g)))},{default:h(()=>[z(" 发消息  ")]),_:1})):(i(),U(L,{key:2,"icon-class":"i-solar:user-plus-bold p-2 mr-2",class:"op-80",type:"primary",onClick:a[2]||(a[2]=F=>y.value=!0)},{default:h(()=>[z(" 添加好友  ")]),_:1}))],512),[[J,!e(t)]]),p(H,{show:e(y),"onUpdate:show":a[3]||(a[3]=F=>ie(y)?y.value=F:null),"user-id":e(g),onSubmit:a[4]||(a[4]=F=>e(s).setTheFriendOpt(("FriendOptType"in l?l.FriendOptType:e(x)).Empty,{}))},null,8,["show","user-id"])],16)}}}),ts=T({__name:"Index",props:{data:{}},setup(_){const r={[x.User]:es,[x.NewFriend]:qt,[x.GroupFriend]:Ot};return(u,t)=>(i(),U(Re(r[u.data.type||("FriendOptType"in u?u.FriendOptType:e(x)).User]),ue({data:u.data},u.$attrs),null,16,["data"]))}}),ss=_=>(ee("data-v-61bd6582"),_=_(),te(),_),os={key:1,class:"w-5/7 flex-row-c-c flex-1 flex-shrink-0 bg-color"},as=ss(()=>o("i",{"i-solar:users-group-two-rounded-bold-duotone":"","p-2rem":"","op-40":""},null,-1)),ns=T({__name:"friend",setup(_){Be({title:"极聊天 - 极物圈 👑",description:"极聊天 - 极物圈 开启你的极物之旅！",keywords:"社区,商城,极物之旅,主页,聊天,客服,购物,home,index,shop,chat"}),A();const r=N();return(u,t)=>{const n=At,c=ts,d=re,v=Ae;return i(),f("div",null,[p(v,{name:"chat",header:!0,"left-menu":!0,footer:!1},{default:h(()=>[p(n,{class:"w-2/7 flex-shrink-0 p-4"}),e(r).theFriendOpt.type!==("FriendOptType"in u?u.FriendOptType:e(x)).Empty?(i(),U(c,{key:0,data:e(r).theFriendOpt,class:"w-5/7 flex-1 flex-shrink-0 bg-color"},null,8,["data"])):(i(),f("div",os,[p(d,{"mt-10":"","image-size":80,description:" "},{image:h(()=>[as]),_:1})]))]),_:1})])}}}),Fs=O(ns,[["__scopeId","data-v-61bd6582"]]);export{Fs as default};
