import{o as u,go as z,gq as w,u as x,S as D}from"./entry.HuYbGiLS.js";import{u as H}from"./useWs.6oZqrKhZ.js";import{a as o}from"./swiper-vue.4ZhlhtKr.js";function J(t,e=10,r=null,c){return u.get("/chat/message/page",{roomId:t,pageSize:e,cursor:r},{headers:{Authorization:c}})}var R=(t=>(t[t.TEXT=1]="TEXT",t[t.RECALL=2]="RECALL",t[t.IMG=3]="IMG",t[t.FILE=4]="FILE",t[t.SOUND=5]="SOUND",t[t.VIDEO=6]="VIDEO",t[t.EMOJI=7]="EMOJI",t[t.SYSTEM=8]="SYSTEM",t[t.AI_CHAT=9]="AI_CHAT",t))(R||{});function M(t,e){return u.post("/chat/message",{...t},{headers:{Authorization:e}})}function V(t,e,r){return u.put(`/chat/message/recall/${t}/${e}`,{},{headers:{Authorization:r}})}function $(t,e){return u.put(`/chat/message/msg/read/${t}`,{},{headers:{Authorization:e}})}const X=z("chat",()=>{const t=o({activeTime:"",avatar:"",roomId:1,hotFlag:1,name:"",text:"",type:1,unreadCount:0,msgList:[],unreadMsgList:[]});function e(n,a=[],s=[]){n&&(n.unreadCount=0,t.value=n),a&&(t.value.msgList=a),s&&(t.value.unreadMsgList=s)}const r=o([]);function c(n,a=""){const s=x();$(n,s.getToken).then(I=>{if(I.code!==D.SUCCESS)return!1;t.value.unreadCount=0,a&&(t.value.text=a);const C=H();C.wsMsgList.newMsg=C.wsMsgList.newMsg.filter(F=>F.message.roomId!==n)}).catch(()=>{})}const g=(n=20,a,s=!0,I)=>{},A=()=>{},v=(n,a=0)=>{},i=o([]);function S(n){i.value.find(s=>s.userId===n.userId)||i.value.push(n)}function L(n){const a=i.value.findIndex(s=>s.userId===n.userId);a!==void 0&&i.value.splice(a,1)}const f=o();function m(n){f.value=n}const d=o({type:-1,data:{}});function E(n,a){d.value.type=n,d.value.data=a}const l=o("");function O(n){l.value=n}const h=o(!1);function U(n){h.value=n}return{theContact:t,replyMsg:f,atUserList:i,theFriendOpt:d,delUserId:l,isAddNewFriend:h,onOfflineList:r,setContact:e,setReadList:c,setIsAddNewFriend:U,setAtUid:S,removeAtUid:L,setReplyMsg:m,setDelUserId:O,setTheFriendOpt:E,onReloadContact:g,scrollReplyMsg:v,scrollBottom:A}},{persist:{storage:w.localStorage}});function Y(t=10,e=null,r){return u.get("/chat/contact/page",{pageSize:t,cursor:e},{headers:{Authorization:r}})}var G=(t=>(t[t.GROUP=1]="GROUP",t[t.SELFT=2]="SELFT",t[t.AICHAT=3]="AICHAT",t))(G||{});function _(t,e=1,r){if(e===1)return u.get(`/chat/contact/${t}`,{},{headers:{Authorization:r}});if(e===2)return u.get(`/chat/contact/self/${t}`,{},{headers:{Authorization:r}})}export{R as M,G as R,Y as a,J as b,M as c,_ as g,V as r,X as u};
