import{E as G,a as R}from"./checkbox.zfGg0ai0.js";import{_ as F}from"./ShopLine.8vISMB1F.js";import{_ as H}from"./nuxt-link.AUBdcVxd.js";import{_ as Q}from"./AutoIncre.vue.cpfunnOh.js";import{E as J}from"./scrollbar.VqFpSCdd.js";import{ah as K,ac as W,u as X,L as S,h as Y,br as Z,i as ee,e as te,a as oe,G as I,bs as ae,S as se,E as $,f as le}from"./entry.t-rqPOs0.js";/* empty css                       */import{j as ne,a as p,b as re,k as ie,ap as ce,O as u,P as b,$ as i,a2 as r,Q as o,u as e,a5 as C,a6 as m,x as V,a0 as de,as as ue,a8 as L,ab as O,ac as pe,a7 as N,an as me,ao as _e}from"./swiper-vue.Dj7aAS3P.js";import{u as fe}from"./useOrderStore.eUMUt3Tv.js";import"./isEqual.OSnr_sHV.js";import"./hasIn.6fummut8.js";import"./flatten.qRdZVAia.js";import"./ElImage.MMEIiX96.js";import"./debounce.0E-5_dMF.js";import"./select.CPu1gYEQ.js";import"./popper.b7Al0Wsi.js";import"./tag.C0ahusY6.js";import"./strings.Y1vdtDWm.js";import"./index.dh5FAeg5.js";import"./input-number.O-5fmpcb.js";import"./index.m5OxfFYg.js";import"./sku.3bWIpLkz.js";import"./index.T5JhbHk1.js";const v=_=>(me("data-v-6f80651b"),_=_(),_e(),_),he={class:"mx-a overflow-y-hidden pb-0 layout-default md:w-700px"},be={key:0,class:"shopcart-list",relative:"","mx-a":"","rounded-10px":"","p-4":"","border-default":"","card-default":"","md:p-6":""},ve={"mb-2":"","border-0":"","border-b-1":"","pb-4":"","text-center":"","tracking-0.1em":"","border-default":""},xe=["plain"],ge={"mt-4":"","flex-row-c-c":""},ke=v(()=>o("div",{"opacity-50":""}," 没有更多，继续探索吧~ ",-1)),ye={sticky:"","bottom-4":"","z-99":"",class:"my-4 mb-0 w-full animate-fade-in-up animate-duration-300"},Se={"flex-row-bt-c":"","p-2":"","px-4":""},Ce={"float-left":"","p-1":""},Le={"ml-a":"",flex:"","items-end":""},we=v(()=>o("span",{"p-1":""},"总计：￥",-1)),Ee={"text-red-5":""},Be={class:"h-4em w-full flex items-center justify-between rounded-10px bg-white px-4 backdrop-blur-2em border-default dark-bg-dark-6"},Ie={flex:""},$e=v(()=>o("i",{"i-solar:trash-bin-trash-broken":"","mr-1":""},null,-1)),Ve=v(()=>o("i",{"i-solar:trash-bin-trash-broken":"","mr-1":""},null,-1)),Oe=ne({__name:"shopcart",setup(_){K({title:`我的购物车 - 个人中心 - ${I}`,meta:[{name:"description",content:`我的购物车 - 个人中心 - ${I}`}]});const c=W(),w=X(),d=p(!1),s=p([]);function E(l="删除"){Y({title:`${l}提示！`,message:`确定要${l}吗？`,type:"warning",lockScroll:!1,showClose:!1,center:!0,customClass:"text-center",showCancelButton:!0,cancelButtonText:"取 消",confirmButtonText:"删 除",callback:async t=>{if(t==="confirm"){const{code:a}=await ae(s.value,w.getToken);a===se.SUCCESS&&c.deleteBatchShopCart(s.value)?(s.value.splice(0),$.success(`${l}成功！`)):$.error("删除失败，请稍后再试试看！")}}})}function A(){s.value.push(...c.shopcartList.map(l=>l.id)),E("清空")}const f=p(!1);re(f,l=>{s.value.splice(0),l&&s.value.push(...c.shopcartList.map(t=>t.id))});const B=fe();function z(l){const t=[];c.shopcartList.forEach(a=>{if(l.includes(a.id)){const{skuId:g,quantity:k}=a;t.push({skuId:g,quantity:k})}}),B.clearOrderItems(),B.$patch({pushOrderItems:t}),Z().push({path:"/order/detail"})}const h=p(0),x=p(0),P=ie(()=>{x.value=0,h.value=0;const l=c.shopcartList.filter(a=>s.value.includes(a.id));let t=S(0);return l.forEach(a=>{a.postage&&(h.value+=+a.postage),x.value+=a.quantity,t=t.add(S(a.price).multiply(a.quantity).add(+(a.postage||0)))}),t});return(l,t)=>{const a=G,g=F,k=H,T=Q,U=R,q=J,y=ee,D=te,M=oe,j=ce("incre-up");return u(),b("div",null,[i(M,{name:"user",menu:["back"],footer:!1},{default:r(()=>[o("div",null,[i(D,null,{default:r(()=>[o("main",he,[e(w).isLogin?(u(),b("div",be,[o("h3",ve,[o("small",{style:{"font-size":"1rem"},"float-right":"","my-1":"","cursor-pointer":"","select-none":"",plain:!e(d),class:"transition-300","text-green-5":"",onClick:t[0]||(t[0]=n=>d.value=!e(d))},C(e(d)?"取消":"管理"),9,xe),m(" 购物车 ")]),i(q,{height:"66vh"},{default:r(()=>[i(U,{modelValue:e(s),"onUpdate:modelValue":t[1]||(t[1]=n=>V(s)?s.value=n:null),size:"large",class:"relative"},{default:r(()=>[i(T,{immediate:!0,loading:e(c).isLoading,"no-more":e(c).notMore,onLoad:e(c).loadShopcartList},{done:r(()=>[o("small",ge,[ke,i(k,{to:{path:"/"},class:"ml-2 text-0.8em text-[var(--el-color-info)] opacity-80"},{default:r(()=>[m("前往")]),_:1})])]),default:r(()=>[(u(!0),b(de,null,ue(e(c).shopcartList,n=>(u(),b("li",{key:n.id},[i(g,{"shop-cart":n},{btn:r(()=>[i(a,{label:n.id,disabled:!n.stock},null,8,["label","disabled"])]),_:2},1032,["shop-cart"])]))),128))]),_:1},8,["loading","no-more","onLoad"])]),_:1},8,["modelValue"])]),_:1})])):L("",!0),o("div",ye,[o("div",Se,[o("span",Ce," 共计 "+C(e(x))+" 件 ",1),o("div",Le,[we,O(o("h2",Ee,null,512),[[j,e(P)]])]),O(o("small",{claas:""}," （运费："+C(e(S)(e(h)))+"￥） ",513),[[pe,e(h)>0]])]),o("div",Be,[i(a,{modelValue:e(f),"onUpdate:modelValue":t[2]||(t[2]=n=>V(f)?f.value=n:null),size:"large",label:"全 选"},null,8,["modelValue"]),o("div",Ie,[e(d)&&e(s).length?(u(),N(y,{key:0,class:"fadeInOut flex-1",style:{padding:"0em 1em"},type:"danger",disabled:e(s).length===0&&!e(d),round:"",plain:"",onClick:t[3]||(t[3]=n=>E("批量删除"))},{default:r(()=>[m(" 批量删除 "),$e]),_:1},8,["disabled"])):L("",!0),e(d)?(u(),N(y,{key:1,class:"fadeInOut flex-1",style:{padding:"0em 1em"},type:"danger",plain:"",disabled:!e(d),round:"",onClick:A},{default:r(()=>[Ve,m(" 清空 ")]),_:1},8,["disabled"])):L("",!0),i(y,{class:"fadeInOut flex-1",style:{padding:"0em 2em"},type:"info",round:"",disabled:e(s).length===0,"tracking-0.1em":"",onClick:t[4]||(t[4]=n=>z(e(s)))},{default:r(()=>[m(" 去结算 ")]),_:1},8,["disabled"])])])])])]),_:1})])]),_:1})])}}}),ot=le(Oe,[["__scopeId","data-v-6f80651b"]]);export{ot as default};
