import{_ as me}from"./PreLoading.vue.RcEKquDI.js";import{aH as pe,B as M,h as ie,e as Z,u as Q,t as _e,E as B,S as G,b7 as fe,D as ge,r as ve,c as ye,z as he,b8 as be,f as W,n as ke,aa as $e,w as we,v as Ie,a9 as xe,a as Ce,y as ne}from"./entry.HuYbGiLS.js";import{_ as re}from"./ElImage.H3VTC2Vd.js";import{E as Se}from"./index.Uhk89Gac.js";import{E as Ee}from"./popper.TZrEXPn8.js";/* empty css                */import{j as O,a as k,L as r,M as v,Z as d,a0 as f,N as s,_ as Y,ar as ee,a5 as T,u as a,r as ae,k as K,F as Ue,n as Be,ao as X,a9 as L,a3 as D,a6 as z,a4 as R,aa as J,ai as le,am as de,an as ce,ab as Le,X as Te,x as ze,as as je}from"./swiper-vue.4ZhlhtKr.js";import{E as Ve}from"./upload.0ACO-yOs.js";import{E as De}from"./date-picker.UhiU1TEx.js";import{a as Pe,E as Ne}from"./select.Bh0wcPP9.js";import"./progress.UYU20Rtn.js";/* empty css                */import"./scrollbar.ylZGouLy.js";import{E as Me}from"./tag.Q9i6oaRN.js";import{_ as Oe}from"./nuxt-link.eZ5kOSgI.js";import{_ as Re}from"./TagList.vue.OYkBucBE.js";import{_ as Ke}from"./AutoIncre.vue.KpzenuDu.js";import{b as Ae}from"./post.vbJ-6447.js";import{E as Fe,a as He}from"./tabs.hIqoD_La.js";import{_ as qe}from"./UserPostTotal.vue.tXDYBjip.js";import{_ as Je}from"./SigninCard.vue.yLddT0RR.js";import{g as Ge}from"./index.FQQN3SR7.js";import"./debounce.4-I_Xkye.js";import"./isUndefined.IZwZ21d-.js";import"./cloneDeep.3YksgvLn.js";import"./isEqual.gU3elsgQ.js";import"./localeData.Oasa6b5P.js";import"./arrays.9GuX8ZvT.js";import"./flatten.lVx7POvc.js";import"./index.RtMxj6Hn.js";import"./index.O6n8D2HD.js";import"./strings.PBHHvk2X.js";import"./hasIn.gQarB0Dl.js";import"./fetch.3IR0ILJ_.js";import"./index.gOl6WcbK.js";const Xe={class:"group top-bg relative select-none shadow-lg shadow-inset"},Ze=s("i",{"i-solar:pallete-2-bold":"","h-1.6em":"","w-1.6em":""},null,-1),Qe={class:"img-list"},We=O({__name:"BgToggle",setup(h){const p=k(["/image/kiwi-bg-1.jpg","/image/kiwi-bg-2.jpg","/image/kiwi-bg-3.jpg","/image/kiwi-bg-4.jpg","/image/kiwi-bg-5.jpg"]),e=pe("jiwu_user_bg","/image/kiwi-bg-4.jpg");return(i,y)=>{const _=ie,o=re,n=Z,m=Se;return r(),v("div",Xe,[d(m,{width:400,placement:"top",title:"切换壁纸",teleported:!1,trigger:"click",class:""},{reference:f(()=>[d(_,{class:"absolute bottom-2rem right-2rem z-999 opacity-0 group-hover:opacity-100",type:"info",plain:"",style:{padding:"8px","background-color":"rgba(97, 255, 163, 0.1)",transition:"0.3s"}},{default:f(()=>[Ze]),_:1})]),default:f(()=>[d(n,null,{default:f(()=>[s("div",Qe,[(r(!0),v(Y,null,ee(a(p),($,I)=>(r(),T(o,{key:I,loading:"lazy",alt:"Design By Kiwi23333",src:("BaseUrlImg"in i?i.BaseUrlImg:a(M))+$,"object-cover":"",class:"hover: m-1 h-4em w-1/1 w-6em rounded-4px object-cover transition-300 hover:scale-110 border-default",onClick:E=>e.value=$},null,8,["src","onClick"]))),128))])]),_:1})]),_:1}),d(o,{loading:"lazy",src:("BaseUrlImg"in i?i.BaseUrlImg:a(M))+a(e),"object-cover":"",class:"h-300px w-1/1 object-cover"},null,8,["src"])])}}}),te=h=>(de("data-v-52146557"),h=h(),ce(),h),Ye={class:"avatar shadow-md"},et={class:"group relative flex-row-c-c"},tt=["src"],at=te(()=>s("i",{class:"i-solar:camera-broken absolute p-5 opacity-0 transition-300 group-hover:opacity-60"},null,-1)),ot={class:"text inline-flex flex-col items-start px-2"},st={tag:"div",class:"my-2"},nt={key:"nickname1",class:"group"},lt={key:"nickname-input",class:"flex-row-c-c"},it={class:"group small-input cursor-pointer opacity-60"},rt={class:"i-solar:copy-broken mx-2 cursor-pointer bg-blueGray p-2 transition-300 hover:bg-[var(--el-color-success)]"},dt={"mt-4":"",flex:"","flex-row":"","flex-col":"","flex-wrap":"","gap-2":"","op-80":"","transition-200":"","hover:op-100":""},ct={class:"small-input mt-3 flex items-center justify-start"},ut=te(()=>s("small",null,"签名：",-1)),mt={class:"small-input mt-3 flex-row-c-c justify-start"},pt=te(()=>s("small",null,"生日：",-1)),_t={class:"small-input mt-3 flex-row-c-c justify-start"},ft=te(()=>s("small",null,"性别：",-1)),gt=O({__name:"Line",props:{data:{},isEdit:{type:Boolean}},setup(h){const{data:p}=h,e=ae(p),i=Q(),y=new FormData,_=k(),o=K({get(){return e==null?void 0:e.avatar},set(l){e.avatar=l}}),n=k(!1),m=k(["image/png","image/jpg","image/jpeg","image/svg"]),$=l=>{if(n.value=!0,m.value.includes(l.type)){if(l.size/1024/1024>2)return n.value=!1,B.error("头像需要小于2MB!"),!1}else return n.value=!1,B.error("文件格式不是图片格式!"),!1;return y.append("file",l),!0},I=async(l,t)=>{var b;n.value=!1,(b=_.value)==null||b.clearFiles(),l.code===G.SUCCESS?(e.avatar=l.data,o.value=l.data||"",B.success("更换头像成功！")):B.error(l.message)},E=k(["男","女","保密"]),c=ae({nickname:e==null?void 0:e.nickname,slogan:e==null?void 0:e.slogan,gender:e==null?void 0:e.gender,birthday:e==null?void 0:e.birthday}),x=k(!1),g=k(!1);async function w(l){if(Object.keys(c).includes(l)){if(!JSON.parse(JSON.stringify(c))[l])return B.error("内容不能为空！");if(n.value)return;const{code:t,message:b}=await fe(ge({nickname:e==null?void 0:e.nickname,slogan:e==null?void 0:e.slogan,gender:e==null?void 0:e.gender,birthday:e==null?void 0:e.birthday},{...c}),i.getToken);t===G.SUCCESS?(B.success("修改成功！"),i.$patch({userInfo:{...c}})):B.error(b||"修改失败，请稍后重试！"),g.value=!1,x.value=!1}}function S(){ve(`${document.URL}?id=${e==null?void 0:e.id}`).then(()=>{B.success("链接已复制到剪切板！")}).catch(()=>{B.error("链接分享失败！")})}return Ue(()=>{Be(()=>{c.slogan=e==null?void 0:e.slogan,c.birthday=e==null?void 0:e.birthday,c.gender=e==null?void 0:e.gender})}),(l,t)=>{var oe,se;const b=be,C=Ve,j=ie,V=ye,P=Ee,U=De,N=Ne,F=Pe,H=he,q=X("auto-animate"),ue=X("copying");return r(),v("div",null,[L((r(),v("div",Ye,[d(C,{ref_key:"avatatRef",ref:_,disabled:l.isEdit,class:"avatar-uploader",drag:"",action:`${"BaseUrl"in l?l.BaseUrl:a(_e)}/user/info/avatar`,headers:{Authorization:a(i).token},method:"PUT",limit:1,multiple:!1,"auto-upload":"","show-file-list":!1,"list-type":"picture","before-upload":$,"on-success":I},{default:f(()=>[s("div",et,[a(o)?(r(),v("img",{key:0,alt:"Design By Kiwi23333",src:("BaseUrlImg"in l?l.BaseUrlImg:a(M))+a(o),class:"avatar-mark h-6em w-6em overflow-hidden object-cover p-0 transition-300 group-hover:filter-blur-4"},null,8,tt)):(r(),T(b,{key:1,size:"2em"})),at])]),_:1},8,["disabled","action","headers"])])),[[H,a(n)]]),s("div",ot,[L((r(),v("div",st,[L(s("h2",nt,[s("span",{onClick:t[0]||(t[0]=u=>g.value=!0)},D((oe=a(e))==null?void 0:oe.nickname),1),l.isEdit?(r(),v("span",{key:0,class:"i-solar:ruler-cross-pen-bold-duotone ml-2 cursor-pointer bg-bluegray p-3 group-hover:bg-[var(--el-color-success)]",onClick:t[1]||(t[1]=u=>g.value=!0)})):z("",!0),d(j,{type:"info",class:"ml-4em opacity-0 border-default group-hover:opacity-100",onClick:S},{default:f(()=>[R(" 分 享 ")]),_:1})],512),[[J,!a(g)]]),l.isEdit?L((r(),v("div",lt,[d(V,{modelValue:a(c).nickname,"onUpdate:modelValue":t[2]||(t[2]=u=>a(c).nickname=u),modelModifiers:{lazy:!0},class:"mr-2",style:{"font-size":"0.9em","font-weight":"700"},placeholder:"修改用户昵称",onFocus:t[3]||(t[3]=u=>g.value=!0),onBlur:t[4]||(t[4]=u=>g.value=!1),onKeyup:t[5]||(t[5]=le(u=>w("nickname"),["enter"]))},null,8,["modelValue"]),d(j,{style:{padding:"0 1.5em"},type:"primary",onClick:t[6]||(t[6]=u=>w("nickname"))},{default:f(()=>[R(" 修改 ")]),_:1})],512)),[[J,a(g)]]):z("",!0)])),[[q]]),s("small",it,[R(" ID："+D((se=a(e))==null?void 0:se.id)+" ",1),d(P,{content:"复制 ID",placement:"bottom","popper-class":"el-popper-init"},{default:f(()=>{var u;return[L(s("span",rt,null,512),[[ue,(u=a(e))==null?void 0:u.id,void 0,{toast:!0}]])]}),_:1})]),s("div",dt,[s("div",ct,[ut,l.isEdit?(r(),T(V,{key:0,modelValue:a(c).slogan,"onUpdate:modelValue":t[7]||(t[7]=u=>a(c).slogan=u),modelModifiers:{lazy:!0},class:"mr-1",size:"small",type:"text",style:{width:"14em"},placeholder:"展示你的个性签名吧~ ✨",onKeyup:t[8]||(t[8]=le(u=>w("slogan"),["enter"])),onFocus:t[9]||(t[9]=u=>x.value=!0),onBlur:t[10]||(t[10]=u=>x.value=!1)},null,8,["modelValue"])):z("",!0),L(d(j,{key:"isEditSlogan-btn",icon:"Select",size:"small",type:"primary",onClick:t[11]||(t[11]=u=>w("slogan"))},null,512),[[J,a(x)]])]),s("div",mt,[pt,d(U,{modelValue:a(c).birthday,"onUpdate:modelValue":t[12]||(t[12]=u=>a(c).birthday=u),modelModifiers:{lazy:!0},type:"date",placeholder:"Pick a day",size:"small",onChange:t[13]||(t[13]=u=>w("birthday"))},null,8,["modelValue"])]),s("div",_t,[ft,d(F,{modelValue:a(c).gender,"onUpdate:modelValue":t[14]||(t[14]=u=>a(c).gender=u),placeholder:"Select",style:{width:"10.5em"},size:"small",onChange:t[15]||(t[15]=u=>w("gender"))},{default:f(()=>[(r(!0),v(Y,null,ee(a(E),u=>(r(),T(N,{key:u,label:u,value:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])])])}}}),vt=W(gt,[["__scopeId","data-v-52146557"]]),A=h=>(de("data-v-526b4ff4"),h=h(),ce(),h),yt={"w-full":"",flex:"","grid-gap-2":""},ht={"max-w-20rem":"",flex:"","flex-col":"",truncate:""},bt={"mt-1":"","opacity-60":""},kt={class:"ml-a"},$t=A(()=>s("i",{"i-solar:crown-star-bold":"","mr-1":"","p-0.5em":""},null,-1)),wt={"mt-1":"","border-0":"","border-t-1px":"","pt-3":"","border-default":""},It={class:"grid grid-cols-3 mt-4 flex gap-4"},xt={key:0,class:"grid mt-4 w-full flex grid-gap-2 truncate opacity-70"},Ct={class:"mt-4 w-full flex-row-bt-c"},St={class:"link-text"},Et=A(()=>s("i",{class:"i-solar:share-outline mr-1 p-0.5em"},null,-1)),Ut=A(()=>s("small",null,"分享",-1)),Bt=[Et,Ut],Lt={flex:""},Tt={class:"link-text tip-group tip-group ml-4"},zt=A(()=>s("i",{class:"i-solar:chat-dots-outline mr-1 p-0.5em"},null,-1)),jt={class:"link-text ml-4"},Vt=A(()=>s("i",{class:"i-solar:like-outline mr-1 p-0.5em"},null,-1)),Dt=O({__name:"PostLineSe",props:{data:{},userId:{}},setup(h){const{data:p}=h;Q();const e=`${location.protocol}/${location==null?void 0:location.host}`,i=K(()=>{const o=(Date.now()-new Date(p.createTime).getTime())/1e3/60;return o>24?p.createTime:o>60?`${Math.floor(o/60)}小时前`:`${Math.floor(o)}分钟前`}),y=K(()=>{var n;const o=[];return o.push(M+p.cover),p.images&&o.push(...(n=p.images.split(",").filter(m=>m))==null?void 0:n.map(m=>M+m)),o});function _(){ke({path:`/community/post/detail/${p==null?void 0:p.id}`})}return(o,n)=>{var g,w,S,l,t,b,C,j,V,P;const m=re,$=Oe,I=Me,E=Re,c=Z,x=X("copying");return r(),v("div",{class:"group grid grid-gap-2 leading-1.4em",onClick:Le(_,["self"])},[s("div",yt,[d($,{to:`/user/info?id=${(g=o.data)==null?void 0:g.userId}`,class:"flex-row-c-c"},{default:f(()=>{var U,N,F,H,q;return[(N=(U=o.data)==null?void 0:U.user)!=null&&N.avatar?(r(),T(m,{key:0,src:("BaseUrlImg"in o?o.BaseUrlImg:a(M))+((H=(F=o.data)==null?void 0:F.user)==null?void 0:H.avatar),class:"mr-2 h-2.6rem w-2.6rem rounded-1/2 border-default card-default"},null,8,["src"])):z("",!0),s("div",ht,[s("span",null,D((q=o.data)==null?void 0:q.user.nickname),1),s("small",bt,D(a(i)),1)])]}),_:1},8,["to"]),s("div",kt,[o.data.isEssence?(r(),T(I,{key:0,class:"font-600 shadow",round:"","ml-2":"",style:{padding:"0.2rem 0.4rem"},type:"warning",effect:"dark"},{default:f(()=>[$t,R(" 精选 ")]),_:1})):z("",!0)])]),s("main",wt,[d($,{tag:"div",to:`/community/post/detail/${(w=o.data)==null?void 0:w.id}`},{default:f(()=>[R(D(o.data.title),1)]),_:1},8,["to"]),s("div",It,[(r(!0),v(Y,null,ee(a(y),(U,N)=>(r(),T(m,{key:N,fit:"cover",class:"h-8rem max-w-16rem v-card",loading:"lazy","preview-teleported":"",src:U,"preview-src-list":a(y)},null,8,["src","preview-src-list"]))),128))]),(l=(S=o.data)==null?void 0:S.tags)!=null&&l.trim()?(r(),v("div",xt,[d(E,{tags:o.data.tags,effect:"light"},null,8,["tags"])])):z("",!0),s("div",Ct,[d(c,null,{default:f(()=>[L((r(),v("span",St,Bt)),[[x,`${e}/community/post/detail/${o.data.id}`,void 0,{toast:!0}]])]),_:1}),s("div",Lt,[s("span",Tt,[zt,s("small",null,D((t=o.data)!=null&&t.comments?`${((b=o.data)==null?void 0:b.comments)>99?"99+":(C=o.data)==null?void 0:C.comments}`:"评论"),1)]),s("span",jt,[Vt,s("small",null,D((j=o.data)!=null&&j.likes?`${((V=o.data)==null?void 0:V.likes)>99?"99+":(P=o.data)==null?void 0:P.likes}`:"点赞"),1)])])])])])}}}),Pt=W(Dt,[["__scopeId","data-v-526b4ff4"]]),Nt={class:"grid grid-gap-6"},Mt=O({__name:"PostListSe",props:{dto:{default:()=>({})},limit:{},class:{default:""},cardClass:{default:""}},setup(h,{expose:p}){const e=h,i=k(!1),y=k([]),_=k(0),o=k(e.limit||10),n=ae({total:-1,pages:-1,current:-1}),m=K(()=>(n==null?void 0:n.total)===0&&n.pages===0),$=K(()=>n.pages>0&&(_.value>=n.pages||e.limit!==void 0&&e.limit<=y.value.length));async function I(){var w,S,l,t,b;if(i.value||$.value||m.value)return;if(e.limit!==void 0&&y.value.length>=e.limit){i.value=!1;return}i.value=!0,_.value++;const{data:g}=await Ae(_.value,o.value,e==null?void 0:e.dto);((w=g.value)==null?void 0:w.code)===G.SUCCESS&&(n.total=(S=g.value)==null?void 0:S.data.total,n.current=(l=g.value)==null?void 0:l.data.current,n.pages=(t=g.value)==null?void 0:t.data.pages,y.value.push(...(b=g.value)==null?void 0:b.data.records),i.value=!1)}function E(){y.value.splice(0),n.total=-1,n.pages=-1,n.current=-1,_.value=0}const c=$e(e.dto),x=k();return we(c,async()=>{x.value||(E(),await I(),x.value=setTimeout(()=>{clearTimeout(x.value),x.value=null},400))},{immediate:!0}),p({clearResult:E,loadPostListPage:I,postList:y,pageInfo:n}),(g,w)=>{const S=Pt,l=Ke,t=Z,b=X("auto-animate");return r(),v("div",null,[d(t,null,{default:f(()=>[L((r(),v("div",Nt,[d(l,{"loading-class":"mx-a my-0.6em h-1.4rem w-1.4rem animate-[spin_2s_infinite_linear] rounded-6px bg-[var(--el-color-info)]",immediate:!0,"no-more":a($)||a(m),onLoad:I},{done:f(()=>[L(s("p",{class:"w-full py-8","text-center":"","tracking-1":"","text-bluegray":""},D(a($)?"暂无更多帖子":"暂无帖子"),513),[[J,a($)||a(m)]])]),default:f(()=>[(r(!0),v(Y,null,ee(a(y),C=>(r(),v("div",{key:C.id},[d(S,{class:Te(["p-4 transition-300 transition-all hover:bg-white hover:shadow hover:dark:bg-dark md:p-6",g.cardClass||"bg-transparent rounded-12px"]),data:C,"user-id":C==null?void 0:C.userId},null,8,["class","data","user-id"])]))),128))]),_:1},8,["no-more"])])),[[b]])]),_:1})])}}}),Ot=W(Mt,[["__scopeId","data-v-30990f34"]]),Rt=O({__name:"Tabs",props:{userId:{}},setup(h){const p=Q(),e=k("帖 子");return(i,y)=>{const _=Ot,o=Fe,n=He;return r(),T(n,{modelValue:a(e),"onUpdate:modelValue":y[0]||(y[0]=m=>ze(e)?e.value=m:null),class:"goods-tabs mt-4 min-h-50vh","tab-position":"top"},{default:f(()=>[d(o,{lazy:"",name:"帖 子",label:"帖 子",class:"animate__animated mt-2 animate-fade-in animate-duration-300","animate-duration-300":""},{default:f(()=>{var m;return[d(_,{dto:{userId:i.userId||((m=a(p).userInfo)==null?void 0:m.id)},class:"grid grid-gap-4"},null,8,["dto"])]}),_:1}),d(o,{lazy:"",class:"animate__animated mt-2 animate-fade-in","animate-duration-300":"",name:"相 关",label:"相 关"})]),_:1},8,["modelValue"])}}}),Kt=W(Rt,[["__scopeId","data-v-8b912226"]]),At={key:0},Ft={class:"flex animate-[fade-in_.3s_ease] layout-default"},Ht={class:"flex flex-1 flex-wrap"},qt={key:0,class:"avatars relative flex-1 -top-5em md:pr-4"},Jt={class:"m-2"},Gt={flex:"","flex-col":"","gap-6":""},Ba=O({__name:"info",async setup(h){var $,I,E;let p,e;const i=k(),y=k(!1),_=Q(),o=Ie(),n=k(!0),m=($=o.query)!=null&&$.id?(I=o.query)==null?void 0:I.id.toString():"";if(y.value=!0,m&&m!==((E=_==null?void 0:_.userInfo)==null?void 0:E.id)){n.value=!1;const c=([p,e]=je(()=>Ge(m,_.getToken)),p=await p,e(),p);c.code===G.SUCCESS?i.value={id:m,...c.data}:(i.value=_.userInfo,n.value=!0),y.value=!1}else i.value=_.userInfo;return xe({title:()=>{var c;return`${n.value?"个人信息":(c=i==null?void 0:i.value)==null?void 0:c.nickname} - 个人中心 - ${ne}`},meta:[{name:"description",content:()=>`个人信息 - 个人中心 - ${ne}`}]}),(c,x)=>{const g=me,w=We,S=vt,l=Kt,t=qe,b=Je,C=Z,j=Ce;return r(),v("div",null,[d(j,{name:"user",menu:["back"]},{default:f(()=>[d(C,null,{fallback:f(()=>[d(g,{class:"w-full",icon:""})]),default:f(()=>{var V,P,U;return[(V=a(_))!=null&&V.getToken?(r(),v("div",At,[d(w,{class:"fixed left-0 top-0 z-0 w-full"}),s("div",Ft,[s("div",Ht,[a(i)?(r(),v("div",qt,[d(S,{data:a(i),"is-edit":a(n)},null,8,["data","is-edit"]),s("div",Jt,[d(l,{"user-id":a(m)},null,8,["user-id"])])])):z("",!0),s("div",Gt,[(P=a(i))!=null&&P.id?(r(),T(t,{key:0,dto:{userId:(U=a(i))==null?void 0:U.id},user:a(i),"grid-class":"grid grid-cols-4 gap-4","card-class":"truncate word-nowrap text-0.85rem",class:"p-4 border-default card-default"},null,8,["dto","user"])):z("",!0),d(b,{class:"sm:w-360px"})])])])])):z("",!0)]}),_:1})]),_:1})])}}});export{Ba as default};
