import{m as O,D as T,u as z,B as H,S as q,e as F,g as j,f as M,o as G,n as K,z as Q,C as X,d as Y,_ as Z,r as J}from"./entry.t-rqPOs0.js";import{_ as ee,a as te}from"./ElImage.MMEIiX96.js";import oe from"./UserLine.Tfd6-hRD.js";import{j as y,O as u,P as p,Z as E,u as o,Q as m,a as V,I as D,k as U,$ as a,a2 as r,a0 as ne,a5 as se,as as ae,a8 as ie,an as P,ao as W,b as re,E as le,ap as de,Y as S,X as N,ab as ce,a7 as ue,a6 as w,at as me}from"./swiper-vue.Dj7aAS3P.js";import{E as pe,a as _e}from"./menu.CxPruqUa.js";/* empty css                  *//* empty css                */import"./popper.b7Al0Wsi.js";import{u as A,b as fe,a as k}from"./useWs.cWBkfbdz.js";import{e as he}from"./friend.psniISnN.js";import{u as ve}from"./useWebToast.biIBmehr.js";import"./debounce.0E-5_dMF.js";import"./avatar.O_LQjIGj.js";import"./upload.1UmVT-Li.js";import"./progress.FoUIz2xX.js";import"./cloneDeep.k3-Muxea.js";import"./isEqual.OSnr_sHV.js";import"./nuxt-link.AUBdcVxd.js";import"./index.uAaZKamD.js";/* empty css                */import"./index.7kUqwZF1.js";import"./notification.YJSnxgg5.js";const ge=m("i",{class:"i-solar:chat-square-bold-duotone","cursor-pointer":"","p-0.6em":""},null,-1),be=[ge],we=y({__name:"ContactBtn",setup(i){const l=O();return(s,d)=>(u(),p("span",{class:E(["ml-a mt-6 p-1 transition-300",o(l).isUserFold?"hover:rotate-15":"hover:-rotate-15"]),onClick:d[0]||(d[0]=_=>o(l).isOpenContact=!o(l).isOpenContact)},be,2))}}),R=i=>(P("data-v-f581367e"),i=i(),W(),i),ke={class:"menu z-998 h-full bg-light bg-opacity-80 backdrop-blur-30 md:static md:block dark:bg-[#121212] md:shadow-none"},ye={class:"w-full flex-row-c-c flex-wrap px-5 transition-300 transition-300 hover:bg-transparent"},Ce={class:"home mt-6 self-center transition-300"},xe=R(()=>m("i",{class:"i-solar:signpost-2-line-duotone","cursor-pointer":"","p-0.6em":""},null,-1)),$e=[xe],Ie=R(()=>m("div",{class:"mx-a my-4 w-5/6 border-0 border-b-1px border-default"},null,-1)),Se={class:"title overflow-hidden px-6 font-500 tracking-0.2em"},Ee=y({__name:"ChatMenu",emits:["close"],setup(i){const l=T(),s=z(),d=A(),_=V(0);async function g(){const f=await he(s.getToken);f.code===q.SUCCESS&&(_.value=f.data.unReadCount)}D(()=>{g()});const C=[{title:"聊天",path:"/chat",icon:"i-solar:chat-line-broken",activeIcon:"i-solar:chat-line-bold-duotone",tipValue:U(()=>d.wsMsgList.newMsg.length)},{title:"好友",path:"/chat/friend",icon:"i-solar:users-group-rounded-line-duotone",activeIcon:"i-solar:users-group-rounded-bold-duotone",tipValue:U(()=>_.value+d.wsMsgList.applyMsg.length)},{title:"设置",path:"/chat/setting",icon:"i-solar:settings-linear",activeIcon:"i-solar:settings-bold-duotone"},{title:"回到首页",path:"/",icon:"i-solar:logout-3-broken"}],c=O();return(f,e)=>{const t=ee,h=oe,x=F,v=we,b=j,$=pe,I=_e;return u(),p("div",ke,[a(I,{router:!0,"default-active":o(l).path,collapse:o(c).isUserFold},{default:r(()=>[m("div",ye,[m("div",Ce,[a(x,null,{default:r(()=>[a(h,{"user-info":o(s).userInfo,"propver-props":{placement:"right-start",trigger:"click",offset:30}},{default:r(()=>[a(t,{src:("BaseUrlImg"in f?f.BaseUrlImg:o(H))+o(s).userInfo.avatar,class:"relative z-100 h-2rem w-2rem border-default card-default",alt:"头像"},null,8,["src"])]),_:1},8,["user-info"])]),_:1})]),a(v),m("span",{class:E(["mt-6 p-1 transition-300",o(c).isUserFold?"hover:rotate-15":"hover:-rotate-15"]),onClick:e[0]||(e[0]=n=>o(c).isUserFold=!o(c).isUserFold)},$e,2)]),Ie,(u(),p(ne,null,ae(C,n=>a($,{key:n.path,index:n.path},{default:r(()=>{var B,L;return[a(b,{value:((B=n==null?void 0:n.tipValue)==null?void 0:B.value)||0,hidden:!((L=n==null?void 0:n.tipValue)!=null&&L.value),max:99},{default:r(()=>[m("i",{class:E(["icon",o(l).path===n.path?n.activeIcon:n.icon])},null,2)]),_:2},1032,["value","hidden"]),m("span",Se,se(n.title),1)]}),_:2},1032,["index"])),64))]),_:1},8,["default-active","collapse"]),o(c).isChatFold?(u(),p("div",{key:0,class:"absolute left-0 top-0 block h-100vh w-100vw overflow-hidden bg-[#8181811a] -z-1 md:hidden",style:{"background-color":"#2222223a"},onClick:e[1]||(e[1]=n=>o(c).isChatFold=!1)})):ie("",!0)])}}}),Me=M(Ee,[["__scopeId","data-v-f581367e"]]),Be=i=>(P("data-v-9504f13d"),i=i(),W(),i),Le=Be(()=>m("div",{class:"hidden h-95vh w-2/7 truncate p-4 md:block md:h-80vh"},null,-1)),Ue={key:2,class:"main-box flex-row-c-c"},Oe=y({__name:"Layout",setup(i){const l=z(),s=A(),d=V();re(()=>l.getToken,e=>{var t;e?g():(t=s.webSocketHandler)==null||t.close()},{immediate:!0,deep:!0});const _=[fe.MESSAGE];function g(){s.initDefault(e=>{d.value=setInterval(()=>{s.status===k.CLOSE?(clearInterval(d.value),d.value=null,g()):s.sendHeart()},1e4),s.onMessage(t=>{if(s.isWindBlur&&_.includes(t.type)){const h=t.data;ve(`${h.fromUser.nickName}:`,`${h.message.content}`,{icon:H+h.fromUser.avatar})}})})}D(()=>{if(!document)return;let e,t;typeof(document==null?void 0:document.hidden)<"u"?(e="hidden",t="visibilitychange"):typeof(document==null?void 0:document.mozHidden)<"u"?(e="mozHidden",t="mozvisibilitychange"):typeof(document==null?void 0:document.msHidden)<"u"?(e="msHidden",t="msvisibilitychange"):typeof(document==null?void 0:document.webkitHidden)<"u"&&(e="webkitHidden",t="webkitvisibilitychange"),document==null||document.addEventListener(t,()=>{document[e]?s.isWindBlur=!0:s.isWindBlur=!1},!1)});const C=T(),c=G();function f(e){e.preventDefault();const t={x:e.x,y:e.y,theme:c.preference==="dark"?"mac dark":"wind10",items:[{icon:c.preference==="light"?"i-solar:moon-stars-bold-duotone  text-[var(--el-color-primary)]":"i-solar:sun-bold text-[var(--el-color-warning)]",shortcut:"Alt+K",label:c.preference==="dark"?"切换日间":"切换夜间",onClick:()=>{Q(c.preference==="dark"?"light":"dark",e)}}]};X.showContextMenu(t)}return le(()=>{var e;C.path.startsWith("/chat")||(clearInterval(d.value),s.webSocketHandler&&((e=s.webSocketHandler)==null||e.close()),d.value=!1)}),(e,t)=>{const h=te,x=Me,v=Y,b=Z,$=F,I=de("auth");return u(),p("div",null,[a($,null,{fallback:r(()=>[m("div",S(e.$attrs,{class:"main-box"}),[Le,a(h,{class:"h-95vh flex-row-c-c flex-1 border-0 border-l-1px op-60 md:h-80vh border-default bg-color"})],16)]),default:r(()=>[o(l).isLogin&&o(s).status===o(k).OPEN?(u(),p("div",S({key:0,class:"main-box"},e.$attrs,{onDblclick:t[0]||(t[0]=n=>f(n))}),[a(x),N(e.$slots,"default",{},void 0,!0)],16)):o(l).isLogin&&o(s).status!==o(k).OPEN?(u(),p("div",S({key:1},e.$attrs,{class:"main-box max-w-100vw flex-row-c-c overflow-hidden"}),[a(b,{msg:o(s).status===o(k).CLOSE?"服务连接失败，请重试":"服务断开连接，请重连",icon:"i-solar:eye-line-duotone w-8rem h-8rem animate-[0.2s_fade-in_3]"},{footer:r(()=>[ce((u(),ue(v,{"icon-class":"i-solar:refresh-outline mr-2",class:"hover:shadow-md",type:"primary","transition-icon":"",onClick:t[1]||(t[1]=n=>g())},{default:r(()=>[w(" 重新连接 ")]),_:1})),[[I]]),a(v,{"icon-class":"i-solar:home-2-bold mr-2",class:"hover:shadow-md",plain:"","transition-icon":"",onClick:t[2]||(t[2]=n=>("navigateTo"in e?e.navigateTo:o(K))("/"))},{default:r(()=>[w(" 回到首页 ")]),_:1})]),_:1},8,["msg"])],16)):(u(),p("div",Ue,[a(b,{msg:"未登录,请登录后查看!",icon:"i-solar:eye-line-duotone w-8rem h-8rem animate-[0.2s_fade-in_3]"},{footer:r(()=>[a(v,{plain:"",onClick:t[3]||(t[3]=n=>e.$router.back())},{default:r(()=>[w(" 返 回 ")]),_:1}),a(v,{"icon-class":"i-solar:user-rounded-outline mr-2",class:"hover:shadow-md",type:"primary","transition-icon":"",onClick:t[4]||(t[4]=n=>o(l).showLoginForm=!0)},{default:r(()=>[w(" 登 录 ")]),_:1})]),_:1})]))]),_:3})])}}}),Te=M(Oe,[["__scopeId","data-v-9504f13d"]]),ze=me(()=>J(()=>import("./index.ZUPr0IpR.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]),import.meta.url).then(i=>i.default||i)),He={"h-100vh":"","w-100vw":"","flex-row-c-c":"","overflow-hidden":""},Fe=y({__name:"chat",props:{menu:{default:["back","home","aichat"],required:!1}},setup(i){return(l,s)=>{const d=Te,_=ze;return u(),p("main",He,[a(d,null,{default:r(()=>[N(l.$slots,"default",{},void 0,!0)]),_:3}),a(_,{menu:i.menu},null,8,["menu"])])}}}),it=M(Fe,[["__scopeId","data-v-f2bb5c10"]]);export{it as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index.ZUPr0IpR.js","./entry.t-rqPOs0.js","./swiper-vue.Dj7aAS3P.js","./swiper-vue.CRufKKKm.css","./entry.k6-BttGb.css","./nuxt-link.AUBdcVxd.js","./Main.vue.XLnSog5g.js","./contact.O0MKBF5K.js","./useWs.cWBkfbdz.js","./notification.YJSnxgg5.js","./notification.6oJvQm9r.css","./ElImage.MMEIiX96.js","./debounce.0E-5_dMF.js","./ElImage.dg4y3aGk.css","./tag.C0ahusY6.js","./tag.ItIytdvz.css","./Main.1Yb3qjBM.css","./scrollbar.VqFpSCdd.js","./scrollbar.Smf0pYfu.css","./index.uAaZKamD.js","./popper.b7Al0Wsi.js","./popper.2BhxBuwE.css","./index.QVHnhtCZ.css","./popover.N-GW0j1A.css","./menu-item.f0mNRiTD.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
