import{_ as re,a as pe}from"./ElImage.MMEIiX96.js";import{aO as _e,B as N,i as de,e as Z,u as W,ae as fe,E as L,S as H,b4 as ge,J as ve,y as ye,c as he,A as be,b5 as ke,f as X,n as $e,ai as we,w as Ie,D as xe,ah as Ce,a as Se,G as le}from"./entry.t-rqPOs0.js";import{E as Ee}from"./index.uAaZKamD.js";import{E as Ue}from"./popper.b7Al0Wsi.js";/* empty css                */import{j as M,a as k,O as i,P as v,$ as d,a2 as f,Q as s,a0 as Y,as as ee,a7 as U,u as t,r as ae,k as A,I as Be,n as Te,ap as Q,ab as z,a5 as D,a8 as B,a6 as R,ac as G,ak as ie,an as ce,ao as ue,ad as Le,Z as ze,x as je,au as Ve}from"./swiper-vue.Dj7aAS3P.js";import{E as De}from"./upload.1UmVT-Li.js";import{E as Pe}from"./date-picker.Q4Giyn4G.js";import{a as Oe,E as Ne}from"./select.CPu1gYEQ.js";import"./progress.FoUIz2xX.js";/* empty css                */import"./scrollbar.VqFpSCdd.js";import{E as Me}from"./tag.C0ahusY6.js";import{_ as Re}from"./nuxt-link.AUBdcVxd.js";import{_ as Ae}from"./TagList.vue.OeOiiCEW.js";import{_ as Ke}from"./AutoIncre.vue.cpfunnOh.js";import{b as Fe}from"./post.az1H9mBx.js";import{E as Je,a as qe}from"./tabs.zy60X67L.js";import{_ as Ge}from"./UserPostTotal.vue.tWWZmSjH.js";import{_ as He}from"./SigninCard.vue.0TR8jjq9.js";import{g as Qe}from"./index.nPWTgw9q.js";import"./debounce.0E-5_dMF.js";import"./cloneDeep.k3-Muxea.js";import"./isEqual.OSnr_sHV.js";import"./localeData.CPZ9gcTj.js";import"./arrays.9GuX8ZvT.js";import"./flatten.qRdZVAia.js";import"./index.m5OxfFYg.js";import"./index.dh5FAeg5.js";import"./strings.Y1vdtDWm.js";import"./hasIn.6fummut8.js";import"./index.T-hRbm4W.js";const Ze={class:"group top-bg relative select-none shadow-lg shadow-inset"},We=s("i",{"i-solar:pallete-2-bold":"","h-1.6em":"","w-1.6em":""},null,-1),Xe={class:"img-list"},Ye=M({__name:"BgToggle",setup(h){const p=k(["/image/kiwi-bg-1.jpg","/image/kiwi-bg-2.jpg","/image/kiwi-bg-3.jpg","/image/kiwi-bg-4.jpg","/image/kiwi-bg-5.jpg"]),e=_e("jiwu_user_bg","/image/kiwi-bg-4.jpg");return(r,y)=>{const _=de,o=re,n=Z,m=Ee;return i(),v("div",Ze,[d(m,{width:400,placement:"top",title:"切换壁纸",teleported:!1,trigger:"click",class:""},{reference:f(()=>[d(_,{class:"absolute bottom-2rem right-2rem z-999 opacity-0 group-hover:opacity-100",type:"info",plain:"",style:{padding:"8px","background-color":"rgba(97, 255, 163, 0.1)",transition:"0.3s"}},{default:f(()=>[We]),_:1})]),default:f(()=>[d(n,null,{default:f(()=>[s("div",Xe,[(i(!0),v(Y,null,ee(t(p),($,I)=>(i(),U(o,{key:I,loading:"lazy",alt:"Design By Kiwi23333",src:("BaseUrlImg"in r?r.BaseUrlImg:t(N))+$,"object-cover":"",class:"hover: m-1 h-4em w-1/1 w-6em rounded-4px object-cover transition-300 hover:scale-110 border-default",onClick:E=>e.value=$},null,8,["src","onClick"]))),128))])]),_:1})]),_:1}),d(o,{loading:"lazy",src:("BaseUrlImg"in r?r.BaseUrlImg:t(N))+t(e),"object-cover":"",class:"h-300px w-1/1 object-cover"},null,8,["src"])])}}}),te=h=>(ce("data-v-d8071dc8"),h=h(),ue(),h),et={class:"avatar shadow-md"},tt={class:"group relative flex-row-c-c"},at=["src"],ot=te(()=>s("i",{class:"i-solar:camera-broken absolute p-5 opacity-0 transition-300 group-hover:opacity-60"},null,-1)),st={class:"text inline-flex flex-col items-start px-2"},nt={tag:"div",class:"my-2"},lt={key:"nickname1",class:"group"},it={key:"nickname-input",class:"flex-row-c-c"},rt={class:"group small-input cursor-pointer opacity-60"},dt={class:"i-solar:copy-broken mx-2 cursor-pointer bg-blueGray p-2 transition-300 hover:bg-[var(--el-color-success)]"},ct={"mt-4":"",flex:"","flex-row":"","flex-col":"","flex-wrap":"","gap-2":"","op-80":"","transition-200":"","hover:op-100":""},ut={class:"small-input mt-3 flex items-center justify-start"},mt=te(()=>s("small",null,"签名：",-1)),pt={class:"small-input mt-3 flex-row-c-c justify-start"},_t=te(()=>s("small",null,"生日：",-1)),ft={class:"small-input mt-3 flex-row-c-c justify-start"},gt=te(()=>s("small",null,"性别：",-1)),vt=M({__name:"Line",props:{data:{},isEdit:{type:Boolean}},setup(h){const{data:p}=h,e=ae(p),r=W(),y=new FormData,_=k(),o=A({get(){return e==null?void 0:e.avatar},set(l){e.avatar=l}}),n=k(!1),m=k(["image/png","image/jpg","image/jpeg","image/svg"]),$=l=>{if(n.value=!0,m.value.includes(l.type)){if(l.size/1024/1024>2)return n.value=!1,L.error("头像需要小于2MB!"),!1}else return n.value=!1,L.error("文件格式不是图片格式!"),!1;return y.append("file",l),!0},I=async(l,a)=>{var b;n.value=!1,(b=_.value)==null||b.clearFiles(),l.code===H.SUCCESS?(e.avatar=l.data,o.value=l.data||"",L.success("更换头像成功！")):L.error(l.message)},E=k(["男","女","保密"]),c=ae({nickname:e==null?void 0:e.nickname,slogan:e==null?void 0:e.slogan,gender:e==null?void 0:e.gender,birthday:e==null?void 0:e.birthday}),x=k(!1),g=k(!1);async function w(l){if(Object.keys(c).includes(l)){if(!JSON.parse(JSON.stringify(c))[l])return L.error("内容不能为空！");if(n.value)return;const{code:a,message:b}=await ge(ve({nickname:e==null?void 0:e.nickname,slogan:e==null?void 0:e.slogan,gender:e==null?void 0:e.gender,birthday:e==null?void 0:e.birthday},{...c}),r.getToken);a===H.SUCCESS?(L.success("修改成功！"),r.$patch({userInfo:{...c}})):L.error(b||"修改失败，请稍后重试！"),g.value=!1,x.value=!1}}function S(){ye(`${document.URL}?id=${e==null?void 0:e.id}`).then(()=>{L.success("链接已复制到剪切板！")}).catch(()=>{L.error("链接分享失败！")})}return Be(()=>{Te(()=>{c.slogan=e==null?void 0:e.slogan,c.birthday=e==null?void 0:e.birthday,c.gender=e==null?void 0:e.gender})}),(l,a)=>{var oe,se,ne;const b=ke,C=De,j=de,V=he,P=Ue,T=Pe,O=Ne,F=Oe,J=be,q=Q("auto-animate"),me=Q("copying");return i(),v("div",null,[z((i(),v("div",et,[d(C,{ref_key:"avatatRef",ref:_,disabled:l.isEdit,class:"avatar-uploader",drag:"",action:`${"BaseUrl"in l?l.BaseUrl:t(fe)}/user/info/avatar`,headers:{Authorization:t(r).token},method:"PUT",limit:1,multiple:!1,"auto-upload":"","show-file-list":!1,"list-type":"picture","before-upload":$,"on-success":I},{default:f(()=>[s("div",tt,[t(o)?(i(),v("img",{key:0,alt:"Design By Kiwi23333",src:("BaseUrlImg"in l?l.BaseUrlImg:t(N))+t(o),class:"avatar-mark h-6em w-6em overflow-hidden object-cover p-0 transition-300 group-hover:filter-blur-4"},null,8,at)):(i(),U(b,{key:1,size:"2em"})),ot])]),_:1},8,["disabled","action","headers"])])),[[J,t(n)]]),s("div",st,[z((i(),v("div",nt,[z(s("h2",lt,[s("span",{onClick:a[0]||(a[0]=u=>g.value=!0)},D((oe=t(e))==null?void 0:oe.nickname),1),l.isEdit?(i(),v("span",{key:0,class:"i-solar:ruler-cross-pen-bold-duotone ml-2 cursor-pointer bg-bluegray p-3 group-hover:bg-[var(--el-color-success)]",onClick:a[1]||(a[1]=u=>g.value=!0)})):B("",!0),d(j,{type:"info",class:"ml-4em opacity-0 border-default group-hover:opacity-100",onClick:S},{default:f(()=>[R(" 分 享 ")]),_:1})],512),[[G,!t(g)]]),l.isEdit?z((i(),v("div",it,[d(V,{modelValue:t(c).nickname,"onUpdate:modelValue":a[2]||(a[2]=u=>t(c).nickname=u),modelModifiers:{lazy:!0},class:"mr-2",style:{"font-size":"0.9em","font-weight":"700"},placeholder:"修改用户昵称",onFocus:a[3]||(a[3]=u=>g.value=!0),onBlur:a[4]||(a[4]=u=>g.value=!1),onKeyup:a[5]||(a[5]=ie(u=>w("nickname"),["enter"]))},null,8,["modelValue"]),d(j,{style:{padding:"0 1.5em"},type:"primary",onClick:a[6]||(a[6]=u=>w("nickname"))},{default:f(()=>[R(" 修改 ")]),_:1})],512)),[[G,t(g)]]):B("",!0)])),[[q]]),s("small",rt,[R(" ID："+D((se=t(e))==null?void 0:se.id)+" ",1),(ne=t(e))!=null&&ne.id?(i(),U(P,{key:0,content:"复制 ID",placement:"bottom","popper-class":"el-popper-init"},{default:f(()=>{var u;return[z(s("span",dt,null,512),[[me,(u=t(e))==null?void 0:u.id,void 0,{toast:!0}]])]}),_:1})):B("",!0)]),s("div",ct,[s("div",ut,[mt,l.isEdit?(i(),U(V,{key:0,modelValue:t(c).slogan,"onUpdate:modelValue":a[7]||(a[7]=u=>t(c).slogan=u),modelModifiers:{lazy:!0},class:"mr-1",size:"small",type:"text",style:{width:"14em"},placeholder:"展示你的个性签名吧~ ✨",onKeyup:a[8]||(a[8]=ie(u=>w("slogan"),["enter"])),onFocus:a[9]||(a[9]=u=>x.value=!0),onBlur:a[10]||(a[10]=u=>x.value=!1)},null,8,["modelValue"])):B("",!0),z(d(j,{key:"isEditSlogan-btn",icon:"Select",size:"small",type:"primary",onClick:a[11]||(a[11]=u=>w("slogan"))},null,512),[[G,t(x)]])]),s("div",pt,[_t,d(T,{modelValue:t(c).birthday,"onUpdate:modelValue":a[12]||(a[12]=u=>t(c).birthday=u),modelModifiers:{lazy:!0},type:"date",placeholder:"Pick a day",size:"small",onChange:a[13]||(a[13]=u=>w("birthday"))},null,8,["modelValue"])]),s("div",ft,[gt,d(F,{modelValue:t(c).gender,"onUpdate:modelValue":a[14]||(a[14]=u=>t(c).gender=u),placeholder:"Select",style:{width:"10.5em"},size:"small",onChange:a[15]||(a[15]=u=>w("gender"))},{default:f(()=>[(i(!0),v(Y,null,ee(t(E),u=>(i(),U(O,{key:u,label:u,value:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])])])}}}),yt=X(vt,[["__scopeId","data-v-d8071dc8"]]),K=h=>(ce("data-v-526b4ff4"),h=h(),ue(),h),ht={"w-full":"",flex:"","grid-gap-2":""},bt={"max-w-20rem":"",flex:"","flex-col":"",truncate:""},kt={"mt-1":"","opacity-60":""},$t={class:"ml-a"},wt=K(()=>s("i",{"i-solar:crown-star-bold":"","mr-1":"","p-0.5em":""},null,-1)),It={"mt-1":"","border-0":"","border-t-1px":"","pt-3":"","border-default":""},xt={class:"grid grid-cols-3 mt-4 flex gap-4"},Ct={key:0,class:"grid mt-4 w-full flex grid-gap-2 truncate opacity-70"},St={class:"mt-4 w-full flex-row-bt-c"},Et={class:"link-text"},Ut=K(()=>s("i",{class:"i-solar:share-outline mr-1 p-0.5em"},null,-1)),Bt=K(()=>s("small",null,"分享",-1)),Tt=[Ut,Bt],Lt={flex:""},zt={class:"link-text tip-group tip-group ml-4"},jt=K(()=>s("i",{class:"i-solar:chat-dots-outline mr-1 p-0.5em"},null,-1)),Vt={class:"link-text ml-4"},Dt=K(()=>s("i",{class:"i-solar:like-outline mr-1 p-0.5em"},null,-1)),Pt=M({__name:"PostLineSe",props:{data:{},userId:{}},setup(h){const{data:p}=h;W();const e=`${location.protocol}/${location==null?void 0:location.host}`,r=A(()=>{const o=(Date.now()-new Date(p.createTime).getTime())/1e3/60;return o>24?p.createTime:o>60?`${Math.floor(o/60)}小时前`:`${Math.floor(o)}分钟前`}),y=A(()=>{var n;const o=[];return o.push(N+p.cover),p.images&&o.push(...(n=p.images.split(",").filter(m=>m))==null?void 0:n.map(m=>N+m)),o});function _(){$e({path:`/community/post/detail/${p==null?void 0:p.id}`})}return(o,n)=>{var g,w,S,l,a,b,C,j,V,P;const m=re,$=Re,I=Me,E=Ae,c=Z,x=Q("copying");return i(),v("div",{class:"group grid grid-gap-2 leading-1.4em",onClick:Le(_,["self"])},[s("div",ht,[d($,{to:`/user/info?id=${(g=o.data)==null?void 0:g.userId}`,class:"flex-row-c-c"},{default:f(()=>{var T,O,F,J,q;return[(O=(T=o.data)==null?void 0:T.user)!=null&&O.avatar?(i(),U(m,{key:0,src:("BaseUrlImg"in o?o.BaseUrlImg:t(N))+((J=(F=o.data)==null?void 0:F.user)==null?void 0:J.avatar),class:"mr-2 h-2.6rem w-2.6rem rounded-1/2 border-default card-default"},null,8,["src"])):B("",!0),s("div",bt,[s("span",null,D((q=o.data)==null?void 0:q.user.nickname),1),s("small",kt,D(t(r)),1)])]}),_:1},8,["to"]),s("div",$t,[o.data.isEssence?(i(),U(I,{key:0,class:"font-600 shadow",round:"","ml-2":"",style:{padding:"0.2rem 0.4rem"},type:"warning",effect:"dark"},{default:f(()=>[wt,R(" 精选 ")]),_:1})):B("",!0)])]),s("main",It,[d($,{tag:"div",to:`/community/post/detail/${(w=o.data)==null?void 0:w.id}`},{default:f(()=>[R(D(o.data.title),1)]),_:1},8,["to"]),s("div",xt,[(i(!0),v(Y,null,ee(t(y),(T,O)=>(i(),U(m,{key:O,fit:"cover",class:"h-8rem max-w-16rem v-card",loading:"lazy","preview-teleported":"",src:T,"preview-src-list":t(y)},null,8,["src","preview-src-list"]))),128))]),(l=(S=o.data)==null?void 0:S.tags)!=null&&l.trim()?(i(),v("div",Ct,[d(E,{tags:o.data.tags,effect:"light"},null,8,["tags"])])):B("",!0),s("div",St,[d(c,null,{default:f(()=>[z((i(),v("span",Et,Tt)),[[x,`${e}/community/post/detail/${o.data.id}`,void 0,{toast:!0}]])]),_:1}),s("div",Lt,[s("span",zt,[jt,s("small",null,D((a=o.data)!=null&&a.comments?`${((b=o.data)==null?void 0:b.comments)>99?"99+":(C=o.data)==null?void 0:C.comments}`:"评论"),1)]),s("span",Vt,[Dt,s("small",null,D((j=o.data)!=null&&j.likes?`${((V=o.data)==null?void 0:V.likes)>99?"99+":(P=o.data)==null?void 0:P.likes}`:"点赞"),1)])])])])])}}}),Ot=X(Pt,[["__scopeId","data-v-526b4ff4"]]),Nt={class:"grid grid-gap-6"},Mt=M({__name:"PostListSe",props:{dto:{default:()=>({})},limit:{},class:{default:""},cardClass:{default:""}},setup(h,{expose:p}){const e=h,r=k(!1),y=k([]),_=k(0),o=k(e.limit||10),n=ae({total:-1,pages:-1,current:-1}),m=A(()=>(n==null?void 0:n.total)===0&&n.pages===0),$=A(()=>n.pages>0&&(_.value>=n.pages||e.limit!==void 0&&e.limit<=y.value.length));async function I(){var w,S,l,a,b;if(r.value||$.value||m.value)return;if(e.limit!==void 0&&y.value.length>=e.limit){r.value=!1;return}r.value=!0,_.value++;const{data:g}=await Fe(_.value,o.value,e==null?void 0:e.dto);((w=g.value)==null?void 0:w.code)===H.SUCCESS&&(n.total=(S=g.value)==null?void 0:S.data.total,n.current=(l=g.value)==null?void 0:l.data.current,n.pages=(a=g.value)==null?void 0:a.data.pages,y.value.push(...(b=g.value)==null?void 0:b.data.records),r.value=!1)}function E(){y.value.splice(0),n.total=-1,n.pages=-1,n.current=-1,_.value=0}const c=we(e.dto),x=k();return Ie(c,async()=>{x.value||(E(),await I(),x.value=setTimeout(()=>{clearTimeout(x.value),x.value=null},400))},{immediate:!0}),p({clearResult:E,loadPostListPage:I,postList:y,pageInfo:n}),(g,w)=>{const S=Ot,l=Ke,a=Z,b=Q("auto-animate");return i(),v("div",null,[d(a,null,{default:f(()=>[z((i(),v("div",Nt,[d(l,{"loading-class":"mx-a my-0.6em h-1.4rem w-1.4rem animate-[spin_2s_infinite_linear] rounded-6px bg-[var(--el-color-info)]",immediate:!0,"no-more":t($)||t(m),onLoad:I},{done:f(()=>[z(s("p",{class:"w-full py-8","text-center":"","tracking-1":"","text-bluegray":""},D(t($)?"暂无更多帖子":"暂无帖子"),513),[[G,t($)||t(m)]])]),default:f(()=>[(i(!0),v(Y,null,ee(t(y),C=>(i(),v("div",{key:C.id},[d(S,{class:ze(["p-4 transition-300 transition-all hover:bg-white hover:shadow hover:dark:bg-dark md:p-6",g.cardClass||"bg-transparent rounded-12px"]),data:C,"user-id":C==null?void 0:C.userId},null,8,["class","data","user-id"])]))),128))]),_:1},8,["no-more"])])),[[b]])]),_:1})])}}}),Rt=X(Mt,[["__scopeId","data-v-30990f34"]]),At=M({__name:"Tabs",props:{userId:{}},setup(h){const p=W(),e=k("帖 子");return(r,y)=>{const _=Rt,o=Je,n=qe;return i(),U(n,{modelValue:t(e),"onUpdate:modelValue":y[0]||(y[0]=m=>je(e)?e.value=m:null),class:"goods-tabs mt-4 min-h-50vh","tab-position":"top"},{default:f(()=>[d(o,{lazy:"",name:"帖 子",label:"帖 子",class:"animate__animated mt-2 animate-fade-in animate-duration-300","animate-duration-300":""},{default:f(()=>{var m;return[d(_,{dto:{userId:r.userId||((m=t(p).userInfo)==null?void 0:m.id)},class:"grid grid-gap-4"},null,8,["dto"])]}),_:1}),d(o,{lazy:"",class:"animate__animated mt-2 animate-fade-in","animate-duration-300":"",name:"相 关",label:"相 关"})]),_:1},8,["modelValue"])}}}),Kt=X(At,[["__scopeId","data-v-8b912226"]]),Ft={key:0},Jt={class:"flex animate-[fade-in_.3s_ease] layout-default"},qt={class:"flex flex-1 flex-wrap"},Gt={key:0,class:"avatars relative flex-1 -top-5em md:pr-4"},Ht={class:"m-2"},Qt={flex:"","flex-col":"","gap-6":""},Ea=M({__name:"info",async setup(h){var $,I,E;let p,e;const r=k(),y=k(!1),_=W(),o=xe(),n=k(!0),m=($=o.query)!=null&&$.id?(I=o.query)==null?void 0:I.id.toString():"";if(y.value=!0,m&&m!==((E=_==null?void 0:_.userInfo)==null?void 0:E.id)){n.value=!1;const c=([p,e]=Ve(()=>Qe(m,_.getToken)),p=await p,e(),p);c.code===H.SUCCESS?r.value={id:m,...c.data}:(r.value=_.userInfo,n.value=!0),y.value=!1}else r.value=_.userInfo;return Ce({title:()=>{var c;return`${n.value?"个人信息":(c=r==null?void 0:r.value)==null?void 0:c.nickname} - 个人中心 - ${le}`},meta:[{name:"description",content:()=>`个人信息 - 个人中心 - ${le}`}]}),(c,x)=>{const g=pe,w=Ye,S=yt,l=Kt,a=Ge,b=He,C=Z,j=Se;return i(),v("div",null,[d(j,{name:"user",menu:["back"]},{default:f(()=>[d(C,null,{fallback:f(()=>[d(g,{class:"w-full",icon:""})]),default:f(()=>{var V,P,T;return[(V=t(_))!=null&&V.getToken?(i(),v("div",Ft,[d(w,{class:"fixed left-0 top-0 z-0 w-full"}),s("div",Jt,[s("div",qt,[t(r)?(i(),v("div",Gt,[d(S,{data:t(r),"is-edit":t(n)},null,8,["data","is-edit"]),s("div",Ht,[d(l,{"user-id":t(m)},null,8,["user-id"])])])):B("",!0),s("div",Qt,[(P=t(r))!=null&&P.id?(i(),U(a,{key:0,dto:{userId:(T=t(r))==null?void 0:T.id},user:t(r),"grid-class":"grid grid-cols-4 gap-4","card-class":"truncate word-nowrap text-0.85rem",class:"p-4 border-default card-default"},null,8,["dto","user"])):B("",!0),d(b,{class:"sm:w-360px"})])])])])):B("",!0)]}),_:1})]),_:1})])}}});export{Ea as default};
