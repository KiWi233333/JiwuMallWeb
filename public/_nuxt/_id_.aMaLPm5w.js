import{u as ee,S as T,g as ve,E as B,f as oe,v as ge,j as he,B as Q,P as ke,i as be,d as we,e as Ce,_ as ye,a as xe,x as Le,y as Ie}from"./entry.HuYbGiLS.js";import{_ as $e}from"./PreLoading.vue.RcEKquDI.js";import{_ as Ee}from"./ElImage.H3VTC2Vd.js";import{_ as Se}from"./Switch.CiJ5_qW7.js";import{E as Te}from"./tag.Q9i6oaRN.js";import{_ as Be}from"./nuxt-link.eZ5kOSgI.js";import{_ as Pe}from"./TagList.vue.OYkBucBE.js";import{E as Ue}from"./divider.Dj8BMgcW.js";import{g as ze,P as v,t as Ae,a as Ne}from"./post.vbJ-6447.js";import{j as te,a as P,k as Oe,F as se,ao as De,L as d,M as k,N as n,X as W,u as e,a4 as u,a3 as I,a9 as Me,am as ae,an as ne,b as Fe,ah as Ke,Z as i,a0 as c,a5 as L,ab as Ve,a6 as E,at as Re}from"./swiper-vue.4ZhlhtKr.js";import{_ as je}from"./CommentPreview.Y9bM1KWX.js";import{_ as Ge}from"./UserPostTotal.vue.tXDYBjip.js";import{_ as He}from"./SigninCard.vue.yLddT0RR.js";import"./debounce.4-I_Xkye.js";import"./useToggleThemeAnima.rqlolBiN.js";import"./category.sBcSORba.js";import"./fetch.3IR0ILJ_.js";import"./composables.QNi8Zuou.js";import"./select.Bh0wcPP9.js";import"./popper.TZrEXPn8.js";import"./isUndefined.IZwZ21d-.js";import"./scrollbar.ylZGouLy.js";import"./strings.PBHHvk2X.js";import"./isEqual.gU3elsgQ.js";import"./hasIn.gQarB0Dl.js";import"./index.O6n8D2HD.js";import"./OssFileUpload.5SsdOgf4.js";import"./progress.UYU20Rtn.js";import"./index.Rr0j-bh8.js";import"./AutoIncre.vue.KpzenuDu.js";import"./notification.mMgfY760.js";import"./index.Uhk89Gac.js";/* empty css                */const Xe=r=>(ae("data-v-2053e54a"),r=r(),ne(),r),Ye={grid:"~ cols-3 gap-4 md:gap-6",class:"mx-a my-6 opacity-60 group-hover:opacity-100"},Ze={class:"action-card"},qe={class:"action-card"},Je={class:"action-btn flex-row-c-c hover:text-[var(--el-color-info)]"},Qe=Xe(()=>n("div",{class:"action-card"},[n("i",{class:"i-solar:share-broken p-1em transition-200 hover:i-solar:share-bold"})],-1)),We=te({__name:"ActionList",props:{postId:{default:""},likes:{default:0},collect:{default:0}},emits:["submit"],setup(r,{emit:_}){const p=r,s=ee(),h=P(!1),$=Oe(()=>location?`${location.href}#post${p.postId}`:""),a=P({like:{value:p.likes,isLike:!1},collect:{value:p.collect,isCollect:!1}});function b(o=v.LIKE,t=1){let l="点赞";o===v.COLLECT&&(l="收藏"),t===0?ve.confirm(`是否取消${l}？`,"取消提示",{lockScroll:!1,confirmButtonText:"确 认",confirmButtonClass:"el-button--danger  border-default ",cancelButtonText:"取 消",center:!0,callback:async m=>{m==="confirm"&&w(l,p.postId,o,t)}}):w(l,p.postId,o,t)}async function w(o,t,l=v.LIKE,m=1){const{data:f,code:g}=await Ae(t,{postId:t,type:l},s.getToken);return g===T.SUCCESS&&(l===v.LIKE?(a.value.like.isLike=!!f,a.value.like.value+=m?1:-1):l===v.COLLECT&&(a.value.collect.isCollect=!!f,a.value.collect.value+=m?1:-1),f?B.success(`${o}成功！`):B.warning(`取消${o}成功！`)),f}return se(async()=>{if(h.value)return;h.value=!0;const{data:o,code:t}=await ze(p.postId,{},s.getTokenFn());t===T.SUCCESS?(o.find(l=>l.type===v.LIKE)!==void 0&&(a.value.like.isLike=!0,a.value.like.value+=1),o.find(l=>l.type===v.COLLECT)!==void 0&&(a.value.collect.isCollect=!0,a.value.collect.value+=1)):(a.value.like.isLike=!1,a.value.collect.isCollect=!1),h.value=!1}),(o,t)=>{var m,f,g,C;const l=De("copying");return d(),k("div",Ye,[n("div",{class:"action-btn flex-row-c-c hover:text-[var(--el-color-danger)]",onClick:t[0]||(t[0]=S=>b(e(v).LIKE,e(a).like.isLike?0:1))},[n("div",Ze,[n("i",{class:W(["p-1em transition-200",e(a).like.isLike?"hover:i-solar:like-broken i-solar:like-bold text-[var(--el-color-danger)]":"hover:i-solar:like-bold i-solar:like-broken"])},null,2)]),u(" "+I(((m=e(a))==null?void 0:m.like.value)>0?(f=e(a))==null?void 0:f.like.value:"点赞"),1)]),n("div",{class:"action-btn flex-row-c-c hover:text-[var(--el-color-warning)]",onClick:t[1]||(t[1]=S=>b(e(v).COLLECT,e(a).collect.isCollect?0:1))},[n("div",qe,[n("i",{class:W(["p-1em transition-200",e(a).collect.isCollect?"hover:i-solar:star-broken i-solar:star-bold text-[var(--el-color-warning)]":"hover:i-solar:star-bold i-solar:star-broken"])},null,2)]),u(" "+I(((g=e(a))==null?void 0:g.collect.value)>0?(C=e(a))==null?void 0:C.collect.value:"收藏"),1)]),Me((d(),k("div",Je,[Qe,u(" 分享 ")])),[[l,e($),void 0,{toast:!0}]])])}}}),eo=oe(We,[["__scopeId","data-v-2053e54a"]]),oo=Re(()=>Le(()=>import("./CateGoryLine.XrpFd2hq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url).then(r=>r.default||r)),to=r=>(ae("data-v-49981676"),r=r(),ne(),r),so={key:0},ao={class:"group fixed left-0 top-0 z-0 h-30vh w-full shadow-md shadow-inset"},no={relative:"","z-1":"","mt-26vh":"","min-h-100vh":"","w-full":"","bg-light":"","dark:bg-black":""},io={grid:"~ cols-1 md:cols-[4fr_1fr] md:gap-6","layout-default-md":"",style:{transform:"translateY(-2rem)"}},lo={"border-default":"","card-default":"",class:"block h-full border-0 border-t-1px p-4 md:p-6"},ro={"w-full":"",flex:"","flex-col":"","grid-gap-4":""},co={for:"content",class:"truncate border-0 border-b-1px py-6 border-default"},mo={class:"group flex items-center"},uo={flex:"","items-center":"","font-600":"","opacity-90":""},_o={"ml-2":"","opacity-50":""},po={key:1,"ml-a":""},fo={flex:"",truncate:"",grid:"~ gap-2"},vo=to(()=>n("i",{"i-solar:crown-star-bold":"","mr-1":"","p-0.5em":""},null,-1)),go={flex:"","flex-col":"","grid-gap-6":""},ho={key:1,class:"h-100vh w-full flex-row-c-c"},ko=te({__name:"[id]",setup(r){var b,w;const _=ee(),p=ge(),s=P(),h=(w=(b=p.params)==null?void 0:b.id)==null?void 0:w.toString();async function $(){const o=await Ne(`${p.params.id}`,_.getTokenFn());o.code===T.SUCCESS&&(s.value=o.data)}se(()=>{_.isLogin&&$()}),Fe(()=>_.isLogin,o=>{o&&$()}),he({title:()=>{var o;return`${((o=s.value)==null?void 0:o.title)||"社区"} - ${Ie}`},description:()=>{var o,t;return`极物圈 - ${(o=s.value)==null?void 0:o.title} - ${(t=s.value)==null?void 0:t.content}！`},keywords:"社区,商城,极物之旅,主页,聊天,客服,购物,home,index,shop,chat"});function a(o){B.warning("该功能未开放！")}return(o,t)=>{const l=$e,m=Ee,f=Se,g=we,C=Te,S=Be,ie=Pe,le=Ke("v-md-preview"),re=Ue,ce=eo,de=je,U=Ce,me=oo,ue=Ge,_e=He,pe=ye,fe=xe;return d(),k("div",null,[i(fe,{name:"second",header:!1,menu:["back",{name:"home",isTeleport:!0}]},{default:c(()=>[i(U,null,{fallback:c(()=>[i(l,{class:"h-100vh w-full flex-row-c-c"})]),default:c(()=>{var z,A,N,O,D,M,F,K,V,R,j,G,H,X,Y,Z,q,J;return[(z=e(_).userInfo)!=null&&z.id?(d(),k("main",so,[n("div",ao,[i(m,{src:("BaseUrlImg"in o?o.BaseUrlImg:e(Q))+((A=e(s))==null?void 0:A.cover),class:"block h-full w-full overflow-hidden backdrop-blur-3",fit:"cover"},null,8,["src"]),i(f,{class:"absolute right-2rem top-2rem z-2 op-0 group-hover:op-100"})]),n("div",no,[n("div",io,[n("section",lo,[n("div",ro,[n("h1",co,I((N=e(s))==null?void 0:N.title),1),n("div",mo,[n("small",uo,[i(m,{src:("BaseUrlImg"in o?o.BaseUrlImg:e(Q))+((D=(O=e(s))==null?void 0:O.user)==null?void 0:D.avatar),class:"mr-2 h-1.8em w-1.8em rounded-1/2 object-cover shadow",fit:"cover"},null,8,["src"]),u(" "+I((F=(M=e(s))==null?void 0:M.user)==null?void 0:F.nickname),1)]),n("small",_o,"发帖时间："+I((K=e(s))==null?void 0:K.createTime),1),((V=e(s))==null?void 0:V.userId)!==((R=e(_).userInfo)==null?void 0:R.id)?(d(),L(g,{key:0,type:"info",round:"",plain:"",class:"ml-a","icon-class":"i-tabler:plus mr-2","transition-icon":!0,size:"small",onClick:t[0]||(t[0]=Ve(y=>{var x;return e(_).getTokenFn()&&a((x=e(s))==null?void 0:x.userId)},["stop"]))},{default:c(()=>[u(" 关注 ")]),_:1})):(d(),k("div",po,[i(C,{type:"info",effect:"dark",round:"",size:"small"},{default:c(()=>[u(" 本人 ")]),_:1}),i(S,{to:`/community/post/new?id=${e(h)}`,class:"ml-2 text-0.8rem"},{default:c(()=>[u(" 编辑 ")]),_:1},8,["to"])]))]),n("div",fo,[(j=e(s))!=null&&j.isEssence?(d(),L(C,{key:0,size:"small",class:"font-600 shadow",round:"",style:{padding:"0.2rem 0.4rem"},type:"warning",effect:"dark"},{default:c(()=>[vo,u(" 精选 ")]),_:1})):E("",!0),i(ie,{size:"small",round:"",tags:(G=e(s))==null?void 0:G.tags,effect:"light"},null,8,["tags"])]),(H=e(s))!=null&&H.content?(d(),L(le,{key:0,"preview-class":"vuepress-markdown-body",text:(X=e(s))==null?void 0:X.content},null,8,["text"])):E("",!0),i(re,{style:{margin:"0.25rem 0",opacity:"0.5"}}),e(_).isLogin?(d(),L(ce,{key:1,"post-id":e(h),likes:(Y=e(s))==null?void 0:Y.likes},null,8,["post-id","likes"])):E("",!0)]),i(U,{fallback:"加载中"},{default:c(()=>{var y,x;return[i(de,{"post-id":`${(x=(y=o._.provides[ke]||o.$route)==null?void 0:y.params)==null?void 0:x.id}`,dto:{isNew:("isTrue"in o?o.isTrue:e(be)).TRUE}},null,8,["post-id","dto"])]}),_:1})]),n("section",go,[i(me,{class:"p-4 border-default card-default md:p-6","post-id":e(h)},null,8,["post-id"]),(Z=e(s))!=null&&Z.user?(d(),L(ue,{key:0,dto:{userId:(q=e(s))==null?void 0:q.userId},user:(J=e(s))==null?void 0:J.user,"grid-class":"grid grid-cols-4 gap-4","card-class":"truncate word-nowrap text-0.85rem",class:"p-4 border-default card-default"},null,8,["dto","user"])):E("",!0),i(_e,{class:"p-4 border-default card-default md:p-6"})])])])])):(d(),k("main",ho,[i(pe,{msg:"未登录,请登录后查看!",icon:"i-solar:eye-line-duotone w-8rem h-8rem animate-[0.2s_fade-in_3]"},{footer:c(()=>[i(g,{plain:"",onClick:t[1]||(t[1]=y=>o.$router.back())},{default:c(()=>[u(" 返 回 ")]),_:1}),i(g,{"icon-class":"i-solar:user-rounded-outline mr-2",class:"hover:shadow-md",type:"primary","transition-icon":"",onClick:t[2]||(t[2]=y=>e(_).showLoginForm=!0)},{default:c(()=>[u(" 登 录 ")]),_:1})]),_:1})]))]}),_:1})]),_:1})])}}}),Wo=oe(ko,[["__scopeId","data-v-49981676"]]);export{Wo as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./CateGoryLine.XrpFd2hq.js","./ElImage.H3VTC2Vd.js","./PreLoading.vue.RcEKquDI.js","./swiper-vue.4ZhlhtKr.js","./swiper-vue.CRufKKKm.css","./entry.HuYbGiLS.js","./entry.NyAeeWMW.css","./debounce.4-I_Xkye.js","./ElImage.Pw9gT8La.css","./nuxt-link.eZ5kOSgI.js","./category.sBcSORba.js","./fetch.3IR0ILJ_.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
