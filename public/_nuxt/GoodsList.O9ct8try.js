import{b as I,_ as C}from"./index.-orXLehy.js";import{_ as $}from"./nuxt-link.AUBdcVxd.js";import{_ as V}from"./AutoIncre.vue.cpfunnOh.js";import{j,a as u,r as D,k as y,O as g,a7 as h,a2 as r,X as w,ab as M,ac as O,u as s,P as b,a5 as x,a8 as P,$ as B,as as R,Q as L,a6 as A,a0 as E,Z as F,a9 as Q,an as X,ao as Z}from"./swiper-vue.Dj7aAS3P.js";import{ai as q,w as H,f as J}from"./entry.t-rqPOs0.js";import"./ElImage.MMEIiX96.js";import"./debounce.0E-5_dMF.js";const K=l=>(X("data-v-5ed468e7"),l=l(),Z(),l),U={class:"ml-a mt-2px text-blueGray"},W=K(()=>L("i",{"i-solar:fire-bold-duotone":"","bg-red-5":"","p-0.6em":""},null,-1)),Y=j({__name:"GoodsList",props:{dto:{default:()=>({})},class:{},size:{default:10},limit:{},load:{type:Boolean},isTimer:{type:Boolean,default:!0},showMoreText:{type:Boolean,default:!0},immediate:{type:Boolean,default:!0},autoStop:{type:Boolean,default:!0},transiton:{default:"fade-bt-list"}},setup(l,{expose:T}){const e=l,n=u(!1),i=u([]),d=u(0),k=u(e.limit||e.size||10),a=D({total:-1,pages:-1,current:-1}),_=y(()=>a.total===0&&a.pages===0),c=y(()=>a.pages>0&&d.value>=a.pages);async function m(){if(c.value||_.value)return;if(e.limit!==void 0&&i.value.length>=e.limit){n.value=!1;return}n.value=!0,d.value++;const{data:t}=await I(d.value,k.value,e==null?void 0:e.dto);if(a.total=t.total,a.current=t.current,a.pages=t.pages,e.isTimer)for await(const o of t.records)o.images=typeof o.images=="string"?o.images.split(","):[],i.value.push(Object.freeze(o));else i.value.push(...Object.freeze(t.records.map(o=>(o.images=typeof o.images=="string"?o.images.split(","):[],o))));e.immediate?n.value=!1:setTimeout(()=>{n.value=!1},300)}function v(){i.value.splice(0),a.total=-1,a.pages=-1,a.current=-1,d.value=0}const S=q(e.dto),p=u();return H(S,async()=>{p.value||(v(),await m(),p.value=setTimeout(()=>{clearTimeout(p.value),p.value=null},400))},{}),e.immediate&&m(),T({clearResult:v,loadGoodsPage:m,goodsList:i,pageInfo:a}),(t,o)=>{const G=C,N=$,z=V;return g(),h(z,{immediate:t.immediate,"no-more":s(c)||s(_),loading:s(n)||!t.immediate,"auto-stop":t.autoStop,onLoad:m},{load:r(()=>[w(t.$slots,"load",{},void 0,!0)]),done:r(()=>[t.showMoreText?M((g(),b("p",{key:0,class:"w-1/1 py-8","text-center":"","text-bluegray":"","tracking-1":""},x(s(c)?"暂无更多商品":"暂无商品"),513)),[[O,s(c)||s(_)]]):P("",!0)]),default:r(()=>[w(t.$slots,"pre",{},void 0,!0),B(Q,{tag:"div",name:t.transiton,class:F(["pb-4",e.class!==null?e.class:"flex flex-wrap"])},{default:r(()=>[(g(!0),b(E,null,R(s(i),f=>(g(),h(N,{key:f.id,to:`/goods/detail/${f.id}`},{default:r(()=>[B(G,{class:"mt-4/100 transition-300 v-card",goods:f},{default:r(()=>[L("small",U,[W,A(" "+x(f.sales),1)])]),_:2},1032,["goods"])]),_:2},1032,["to"]))),128))]),_:1},8,["name","class"])]),_:3},8,["immediate","no-more","loading","auto-stop"])}}}),le=J(Y,[["__scopeId","data-v-5ed468e7"]]);export{le as default};
