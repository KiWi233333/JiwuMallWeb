import{u as x}from"./fetch.3IR0ILJ_.js";import{t as h,aa as V,w as z,f as I}from"./entry.HuYbGiLS.js";import{b as j,_ as E}from"./index.tpBqOViH.js";import{_ as K}from"./nuxt-link.eZ5kOSgI.js";import{ElText as P}from"./index.2AyaIaz8.js";import{j as R,a as c,r as W,k as B,as as A,L as n,M as v,a5 as y,a0 as g,_ as H,ar as J,Z as O,N as G,a4 as C,a3 as T,u as l,X as U,a1 as X,a7 as Y,a9 as Z,aa as q,a6 as $,am as Q,an as ee}from"./swiper-vue.4ZhlhtKr.js";function de(){return x(`${h}/goods/category/tree`,"$HreoDSWYKV")}function me(){return x(`${h}/goods/category/list`,"$5FhJKlx1F0")}function pe(s){return x(`${h}/goods/category/one/${s}`,"$hFrW1zsa4r")}const te=s=>(Q("data-v-a2462ea3"),s=s(),ee(),s),ae={class:"ml-a mt-2px text-blueGray"},oe=te(()=>G("i",{"i-solar:fire-bold-duotone":"","bg-red-5":"","p-0.6em":""},null,-1)),se=R({__name:"GoodsListSsr",props:{dto:{default:()=>({})},class:{},limit:{},load:{type:Boolean},isTimer:{type:Boolean,default:!0},showMoreText:{type:Boolean,default:!0},immediate:{type:Boolean,default:!0},transiton:{}},async setup(s,{expose:L}){let w,b;const e=s,d=c(!1),r=c([]),m=c(0),N=c(e.limit||10),t=W({total:-1,pages:-1,current:-1}),_=B(()=>(t==null?void 0:t.total)===0&&t.pages===0),p=B(()=>t.pages>0&&(m.value>=t.pages||e.limit!==void 0&&e.limit<=r.value.length));async function i(){if(d.value||p.value||_.value)return;if(e.limit!==void 0&&r.value.length>=e.limit){d.value=!1;return}d.value=!0,m.value++;const{data:o}=await j(m.value,N.value,e==null?void 0:e.dto);if(t.total=o.total,t.current=o.current,t.pages=o.pages,e.isTimer)for await(const a of o.records)a.images=typeof a.images=="string"?a.images.split(","):[],r.value.push(Object.freeze(a));else for(const a of o.records)a.images=typeof a.images=="string"?a.images.split(","):[],r.value.push(a);d.value=!1}function k(){r.value.splice(0),t.total=-1,t.pages=-1,t.current=-1,m.value=0}const S=V(e.dto),f=c();return z(S,async()=>{f.value||(k(),await i(),f.value=setTimeout(()=>{clearTimeout(f.value),f.value=null},400))},{}),e.immediate&&i(),L({clearResult:k,loadGoodsPage:i,goodsList:r,pageInfo:t}),e.immediate&&([w,b]=A(()=>i()),await w,b()),(o,a)=>{const D=E,F=K,M=P;return n(),v("div",null,[(n(),y(X(e.transiton?Y:"div"),{tag:"div",name:o.transiton||"fade-bt-list",class:U(["pb-4",e.class!==null?e.class:"flex flex-wrap"])},{default:g(()=>[(n(!0),v(H,null,J(l(r),u=>(n(),y(F,{key:u.id,to:`/goods/detail/${u.id}`},{default:g(()=>[O(D,{class:"mt-4/100 transition-300 v-card",goods:u},{default:g(()=>[G("small",ae,[oe,C(" "+T(u.sales),1)])]),_:2},1032,["goods"])]),_:2},1032,["to"]))),128))]),_:1},8,["name","class"])),o.showMoreText?Z((n(),v("small",{key:0,"mt-2":"",block:"","w-full":"","text-center":"","text-bluegray":"","tracking-1":""},T(l(p)?"暂无更多商品":"暂无商品"),513)),[[q,l(p)||l(_)]]):$("",!0),o.showMoreText&&!l(p)&&!l(_)?(n(),y(M,{key:1,"mt-4":"",block:"","w-full":"","cursor-pointer":"","text-center":"",onClick:a[0]||(a[0]=u=>i())},{default:g(()=>[C(" 加载更多 ")]),_:1})):$("",!0)])}}}),fe=I(se,[["__scopeId","data-v-a2462ea3"]]);export{fe as _,de as a,me as b,pe as g};
