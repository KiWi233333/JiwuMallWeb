import{E as F}from"./divider.Ixn223Qv.js";import{E as M}from"./tag.C0ahusY6.js";import{_ as O}from"./ElImage.MMEIiX96.js";import{_ as Q}from"./nuxt-link.AUBdcVxd.js";import{E as q}from"./empty.RhpDpTy5.js";import{E as G}from"./scrollbar.VqFpSCdd.js";import{ai as H,w as J,B as K,S as W,f as X}from"./entry.t-rqPOs0.js";import{b as Y}from"./post.az1H9mBx.js";import{j as Z,a as c,r as ee,k as N,au as te,ap as ae,O as r,P as f,Q as l,a6 as E,a5 as g,$ as x,a2 as k,ab as oe,a0 as se,as as re,a7 as S,a4 as le,a8 as B,u as h,an as ne,ao as ie}from"./swiper-vue.Dj7aAS3P.js";import"./debounce.0E-5_dMF.js";const L=n=>(ne("data-v-a390a5c5"),n=n(),ie(),n),ce={group:"","h-full":"","p-4":"","card-default":"","md:p-6":""},ue=L(()=>l("i",{"i-solar:fire-bold":"",class:"ml-2 p-0.5em text-[var(--el-color-danger)]"},null,-1)),me={class:"grid"},de={class:"flex items-center gap-3 transition-200 hover:text-[var(--el-color-info)]"},pe={class:"w-12rem flex-1 truncate"},_e={"ml-a":"","w-6rem":"",flex:"","items-center":"","justify-end":"","gap-1":"",truncate:""},ve=L(()=>l("i",{"i-solar:fire-line-duotone":"",class:"scale-0 p-0.5em transition-200 transition-transform group-hover:scale-100"},null,-1)),fe={key:0,class:"block h-0 w-0 overflow-hidden py-0 opacity-0 transition-200 transition-all group-hover:h-6rem group-hover:w-full group-hover:py-2 group-hover:op-100"},ge=Z({__name:"Rank",props:{dto:{default:()=>({})},limit:{},class:{default:""},title:{default:"热门帖子"},immediate:{type:Boolean,default:!1}},async setup(n,{expose:P}){let C,b;const t=n,i=c(!1),o=c([]),u=c(0),z=c(t.limit||10),e=ee({total:-1,pages:-1,current:-1}),T=N(()=>(e==null?void 0:e.total)===0&&e.pages===0),U=N(()=>e.pages>0&&(u.value>=e.pages||t.limit!==void 0&&t.limit<=o.value.length));async function y(){var w,d,p,_,v;if(i.value||U.value||T.value)return;if(t.limit!==void 0&&o.value.length>=t.limit){i.value=!1;return}i.value=!0,u.value++;const{data:a}=await Y(u.value,z.value,t==null?void 0:t.dto);((w=a.value)==null?void 0:w.code)===W.SUCCESS&&(e.total=(d=a.value)==null?void 0:d.data.total,e.current=(p=a.value)==null?void 0:p.data.current,e.pages=(_=a.value)==null?void 0:_.data.pages,o.value.push(...(v=a.value)==null?void 0:v.data.records),i.value=!1)}function I(){o.value.splice(0),e.total=-1,e.pages=-1,e.current=-1,u.value=0}const V=H(t.dto),m=c();P({clearResult:I,loadPostListPage:y,postList:o,pageInfo:e}),J(V,async()=>{m.value||i.value||(I(),await y(),m.value=setTimeout(()=>{clearTimeout(m.value),m.value=null},400))},{immediate:!0});const R=["var(--el-color-danger)","var(--el-color-danger-light-3)","var(--el-color-warning)","var(--el-color-warning-light-3)","var(--el-color-warning-light-5)"];return t.immediate&&([C,b]=te(()=>y()),await C,b()),(a,w)=>{const d=F,p=M,_=O,v=Q,j=q,$=G,A=ae("auto-animate");return r(),f("div",ce,[l("h3",null,[E(g(a.title)+" ",1),ue]),x(d,{"opacity-50":"",style:{margin:"1rem 0"}}),x($,null,{default:k(()=>[oe((r(),f("section",me,[(r(!0),f(se,null,re(h(o),(s,D)=>(r(),S(v,{key:s.id,to:{path:`/community/post/detail/${s.id}`},class:"group pb-6"},{default:k(()=>[l("div",de,[l("h4",{style:le({color:R[D]||""})},g(D+1),5),l("span",pe,g(s.title),1),l("small",_e,[ve,E(" "+g(s.views)+" ",1),s.isEssence?(r(),S(p,{key:0,size:"small",effect:"dark",style:{padding:"0 0.2rem"},type:"warning"},{default:k(()=>[E(" 精 ")]),_:1})):B("",!0)])]),s.cover?(r(),f("div",fe,[x(_,{src:("BaseUrlImg"in a?a.BaseUrlImg:h(K))+s.cover,fit:"cover",class:"h-full w-full v-card"},null,8,["src"])])):B("",!0)]),_:2},1032,["to"]))),128)),h(o).length===0&&h(e).current>0?(r(),S(j,{key:0,description:"暂无帖子"})):B("",!0)])),[[A]])]),_:1})])}}}),Ie=X(ge,[["__scopeId","data-v-a390a5c5"]]);export{Ie as default};
