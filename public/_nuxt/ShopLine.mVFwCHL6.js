import{_ as L}from"./ElImage.H3VTC2Vd.js";import{_ as T}from"./nuxt-link.eZ5kOSgI.js";import{E as N,a as P}from"./select.Bh0wcPP9.js";import{a7 as G,u as M,B as j,G as b,hB as q,S as D,E as u,g as O,e as R,z as A,f as F}from"./entry.HuYbGiLS.js";import{E as Z}from"./input-number.dJQLWHXy.js";import"./tag.Q9i6oaRN.js";import"./scrollbar.ylZGouLy.js";import"./popper.TZrEXPn8.js";import{g as H}from"./sku.o_NVcctg.js";import{j as J,a as p,b as K,k as Q,a9 as W,u as s,L as _,M as v,Z as i,a0 as f,N as n,a3 as g,a4 as X,x as Y,_ as ee,ar as oe,a5 as te,U as ae,z as se}from"./swiper-vue.4ZhlhtKr.js";const re={class:"group mb-3 mt-2 flex-row-bt-c cursor-pointer border-2px rounded-6px transition-300 hover:shadow","border-dashed":"","p-0":"","pr-2":"","border-default":"","md:p-4":"","hover:border":"solid [var(--el-color-primary)]","dark:hover:bg":"dark-1"},ne={style:{width:"78%",height:"100%"},group:"",flex:"","flex-col":"","items-start":"","justify-between":"","overflow-hidden":"",truncate:"","px-4":""},le={"max-w-12em":"","tracking-1px":"","md:max-w-16em":"",class:"... overflow-hidden truncate"},ie={"mb-5":"","mt-1":"","font-700":"","color-red-6":""},ce={"text-0.9em":"","color-coolgray":"",style:{"text-decoration":"line-through"}},de={"flex-row-bt-c":"",class:"mt-2 w-1/1"},ue={relative:"",flex:"","flex-1":"","flex-col":"","items-center":""},pe=J({__name:"ShopLine",props:{shopCart:{}},setup(x){const{shopCart:t}=x,y=G(),C=M(),c=p(!1),m=p(!0),h=p([]),w=p(t.id);K(t,e=>{S(e.skuId,e.quantity)},{deep:!0});async function S(e,o){if(c.value||!o)return;c.value=!0,(await q(w.value,{skuId:e,quantity:o},C.getToken)).code!==D.SUCCESS?(u.closeAll(),u.error("修改失败，稍后重试！")):(t.skuId=e,t.quantity=o);const l=setTimeout(()=>{c.value=!1,clearTimeout(l)},300)}async function k(e){if(e&&m.value){const{data:o}=await H(t.goodsId);setTimeout(()=>{var r;(r=o.value)==null||r.data.forEach(l=>h.value.push(l)),m.value=!1},300)}}function B(e){return`${e.size||""} ${e.color||""} ${e.combo||""}`}const d=Q({get(){return`${t.size||""} ${t.color||""} ${t.combo||""}`},set(e){const o=se(h.value.find(r=>r.id===e));o&&(t.size=o.size,t.image=o.image,t.price=o.price,t.costPrice=o.costPrice,t.color=o.color,t.combo=o.combo,t.skuId=e)}});function E(){O({title:"删除提示",message:"确定要删除吗？",type:"warning",showClose:!1,lockScroll:!1,customClass:"text-center",showCancelButton:!0,cancelButtonText:"取 消",confirmButtonText:"删 除"}).then(async e=>{e==="confirm"&&(await y.deleteShopCartById(t.id)?u.success("删除成功！"):u.error("删除错误，请稍后再试试看！"))}).catch()}return(e,o)=>{const r=L,l=T,I=N,U=P,V=R,$=Z,z=A;return W((_(),v("div",re,[i(l,{to:`/goods/detail/${e.shopCart.goodsId}`},{default:f(()=>[i(r,{loading:"lazy","transition-300":"","hover:transform-scale-110":"",src:("BaseUrlImg"in e?e.BaseUrlImg:s(j))+e.shopCart.image,style:{width:"8em",height:"8em",border:"1px solid #eee","border-radius":"4px"},fit:"cover"},null,8,["src"])]),_:1},8,["to"]),n("div",ne,[n("h3",le,g(e.shopCart.name),1),n("p",ie,[X(" ￥"+g(s(b)(e.shopCart.price))+" ",1),n("span",ce," ￥"+g(s(b)(e.shopCart.costPrice)),1)]),n("p",de,[i(V,null,{default:f(()=>[i(U,{modelValue:s(d),"onUpdate:modelValue":o[0]||(o[0]=a=>Y(d)?d.value=a:null),"no-data-text":"暂无其他规格！","loading-text":"加载中...",loading:s(m),placeholder:s(d),"collapse-tags-tooltip":"",class:"mr-2",size:"small",onVisibleChange:k},{default:f(()=>[(_(!0),v(ee,null,oe(s(h),a=>(_(),te(I,{key:a.id,label:B(a),value:a.id,disabled:a.stock===0},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue","loading","placeholder"])]),_:1}),i($,{modelValue:e.shopCart.quantity,"onUpdate:modelValue":o[1]||(o[1]=a=>e.shopCart.quantity=a),size:"small",min:1,max:99},null,8,["modelValue"])])]),n("div",ue,[n("span",{"i-solar:trash-bin-minimalistic-bold-duotone":"",absolute:"","p-3":"","opacity-0":"","transition-300":"","dark:bg-light":"","group-hover:opacity-80":"",style:{top:"-3em"},onClick:E}),ae(e.$slots,"btn",{},void 0,!0)])])),[[z,s(c)]])}}}),we=F(pe,[["__scopeId","data-v-7a9eed22"]]);export{we as _};
