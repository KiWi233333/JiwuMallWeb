import{_ as Le}from"./PreLoading.vue.RcEKquDI.js";import{aK as B,gC as ze,H as pe,L as H,X as ge,Q as ae,gD as Se,gE as Ce,a2 as we,J as ye,aZ as Ee,M as N,ao as xe,U as Ne,V as Oe,gF as $e,ab as Te,gG as Re,gH as Ae,K as _e,al as A,gB as V,gI as Be,N as he,gJ as Ve,gz as Me,gK as Xe,gm as Ye,e as De,f as Fe}from"./entry.HuYbGiLS.js";import{j as P,q as me,a as w,e as He,s as Pe,k as g,b as de,n as be,F as ke,L as k,a5 as te,Z as d,a0 as p,u as t,X as v,a2 as fe,ab as Ke,N as f,a6 as C,_ as ne,M as E,a1 as je,aa as We,a9 as Ze,ar as Ue,U as ee,ac as qe,aB as Ge,a8 as Je,a3 as Qe,V as ve,I as ea,am as aa,an as ta}from"./swiper-vue.4ZhlhtKr.js";import{d as na}from"./debounce.4-I_Xkye.js";const sa=(l,u)=>{if(!B||!l||!u)return!1;const o=l.getBoundingClientRect();let n;return u instanceof Element?n=u.getBoundingClientRect():n={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},o.top<n.bottom&&o.bottom>n.top&&o.right>n.left&&o.left<n.right};var oa="Expected a function";function ue(l,u,o){var n=!0,y=!0;if(typeof l!="function")throw new TypeError(oa);return ze(o)&&(n="leading"in o?!!o.leading:n,y="trailing"in o?!!o.trailing:y),na(l,u,{leading:n,maxWait:u,trailing:y})}const la=pe({urlList:{type:H(Array),default:()=>ge([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:H(String),default:"anonymous"}}),ra={close:()=>!0,switch:l=>ae(l),rotate:l=>ae(l)},ia=["src","crossorigin"],ca=P({name:"ElImageViewer"}),ua=P({...ca,props:la,emits:ra,setup(l,{expose:u,emit:o}){const n=l,y={CONTAIN:{name:"contain",icon:me(Se)},ORIGINAL:{name:"original",icon:me(Ce)}},{t:I}=we(),i=ye("image-viewer"),{nextZIndex:se}=Ee(),O=w(),K=w([]),x=He(),_=w(!0),M=w(n.crossorigin),h=w(n.initialIndex),b=Pe(y.CONTAIN),c=w({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),X=g(()=>{const{urlList:a}=n;return a.length<=1}),T=g(()=>h.value===0),j=g(()=>h.value===n.urlList.length-1),oe=g(()=>n.urlList[h.value]),le=g(()=>[i.e("btn"),i.e("prev"),i.is("disabled",!n.infinite&&T.value)]),Y=g(()=>[i.e("btn"),i.e("next"),i.is("disabled",!n.infinite&&j.value)]),re=g(()=>{const{scale:a,deg:s,offsetX:r,offsetY:L,enableTransition:S}=c.value;let m=r/a,z=L/a;switch(s%360){case 90:case-270:[m,z]=[z,-m];break;case 180:case-180:[m,z]=[-m,-z];break;case 270:case-90:[m,z]=[-z,m];break}const R={transform:`scale(${a}) rotate(${s}deg) translate(${m}px, ${z}px)`,transition:S?"transform .3s":""};return b.value.name===y.CONTAIN.name&&(R.maxWidth=R.maxHeight="100%"),R}),W=g(()=>ae(n.zIndex)?n.zIndex:se());function $(){ce(),o("close")}function ie(){const a=ue(r=>{switch(r.code){case A.esc:n.closeOnPressEscape&&$();break;case A.space:G();break;case A.left:J();break;case A.up:e("zoomIn");break;case A.right:Q();break;case A.down:e("zoomOut");break}}),s=ue(r=>{const L=r.deltaY||r.deltaX;e(L<0?"zoomIn":"zoomOut",{zoomRate:n.zoomRate,enableTransition:!1})});x.run(()=>{V(document,"keydown",a),V(document,"wheel",s)})}function ce(){x.stop()}function Z(){_.value=!1}function U(a){_.value=!1,a.target.alt=I("el.image.error")}function q(a){if(_.value||a.button!==0||!O.value)return;c.value.enableTransition=!1;const{offsetX:s,offsetY:r}=c.value,L=a.pageX,S=a.pageY,m=ue(R=>{c.value={...c.value,offsetX:s+R.pageX-L,offsetY:r+R.pageY-S}}),z=V(document,"mousemove",m);V(document,"mouseup",()=>{z()}),a.preventDefault()}function D(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function G(){if(_.value)return;const a=Be(y),s=Object.values(y),r=b.value.name,S=(s.findIndex(m=>m.name===r)+1)%a.length;b.value=y[a[S]],D()}function F(a){const s=n.urlList.length;h.value=(a+s)%s}function J(){T.value&&!n.infinite||F(h.value-1)}function Q(){j.value&&!n.infinite||F(h.value+1)}function e(a,s={}){if(_.value)return;const{minScale:r,maxScale:L}=n,{zoomRate:S,rotateDeg:m,enableTransition:z}={zoomRate:n.zoomRate,rotateDeg:90,enableTransition:!0,...s};switch(a){case"zoomOut":c.value.scale>r&&(c.value.scale=Number.parseFloat((c.value.scale/S).toFixed(3)));break;case"zoomIn":c.value.scale<L&&(c.value.scale=Number.parseFloat((c.value.scale*S).toFixed(3)));break;case"clockwise":c.value.deg+=m,o("rotate",c.value.deg);break;case"anticlockwise":c.value.deg-=m,o("rotate",c.value.deg);break}c.value.enableTransition=z}return de(oe,()=>{be(()=>{const a=K.value[0];a!=null&&a.complete||(_.value=!0)})}),de(h,a=>{D(),o("switch",a)}),ke(()=>{var a,s;ie(),(s=(a=O.value)==null?void 0:a.focus)==null||s.call(a)}),u({setActiveItem:F}),(a,s)=>(k(),te(Ge,{to:"body",disabled:!a.teleported},[d(qe,{name:"viewer-fade",appear:""},{default:p(()=>[f("div",{ref_key:"wrapper",ref:O,tabindex:-1,class:v(t(i).e("wrapper")),style:fe({zIndex:t(W)})},[f("div",{class:v(t(i).e("mask")),onClick:s[0]||(s[0]=Ke(r=>a.hideOnClickModal&&$(),["self"]))},null,2),C(" CLOSE "),f("span",{class:v([t(i).e("btn"),t(i).e("close")]),onClick:$},[d(t(N),null,{default:p(()=>[d(t(xe))]),_:1})],2),C(" ARROW "),t(X)?C("v-if",!0):(k(),E(ne,{key:0},[f("span",{class:v(t(le)),onClick:J},[d(t(N),null,{default:p(()=>[d(t(Ne))]),_:1})],2),f("span",{class:v(t(Y)),onClick:Q},[d(t(N),null,{default:p(()=>[d(t(Oe))]),_:1})],2)],64)),C(" ACTIONS "),f("div",{class:v([t(i).e("btn"),t(i).e("actions")])},[f("div",{class:v(t(i).e("actions__inner"))},[d(t(N),{onClick:s[1]||(s[1]=r=>e("zoomOut"))},{default:p(()=>[d(t($e))]),_:1}),d(t(N),{onClick:s[2]||(s[2]=r=>e("zoomIn"))},{default:p(()=>[d(t(Te))]),_:1}),f("i",{class:v(t(i).e("actions__divider"))},null,2),d(t(N),{onClick:G},{default:p(()=>[(k(),te(je(t(b).icon)))]),_:1}),f("i",{class:v(t(i).e("actions__divider"))},null,2),d(t(N),{onClick:s[3]||(s[3]=r=>e("anticlockwise"))},{default:p(()=>[d(t(Re))]),_:1}),d(t(N),{onClick:s[4]||(s[4]=r=>e("clockwise"))},{default:p(()=>[d(t(Ae))]),_:1})],2)],2),C(" CANVAS "),f("div",{class:v(t(i).e("canvas"))},[(k(!0),E(ne,null,Ue(a.urlList,(r,L)=>Ze((k(),E("img",{ref_for:!0,ref:S=>K.value[L]=S,key:r,src:r,style:fe(t(re)),class:v(t(i).e("img")),crossorigin:M.value,onLoad:Z,onError:U,onMousedown:q},null,46,ia)),[[We,L===h.value]])),128))],2),ee(a.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var da=_e(ua,[["__file","image-viewer.vue"]]);const fa=he(da),va=pe({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:H([String,Object])},previewSrcList:{type:H(Array),default:()=>ge([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:H(String),default:"anonymous"}}),ma={load:l=>l instanceof Event,error:l=>l instanceof Event,switch:l=>ae(l),close:()=>!0,show:()=>!0},pa=["src","loading","crossorigin"],ga={key:0},wa=P({name:"ElImage",inheritAttrs:!1}),ya=P({...wa,props:va,emits:ma,setup(l,{emit:u}){const o=l;let n="";const{t:y}=we(),I=ye("image"),i=Je(),se=Ve(),O=w(),K=w(o.crossorigin),x=w(!1),_=w(!0),M=w(!1),h=w(),b=w(),c=B&&"loading"in HTMLImageElement.prototype;let X,T;const j=g(()=>[I.e("inner"),Y.value&&I.e("preview"),_.value&&I.is("loading")]),oe=g(()=>i.style),le=g(()=>{const{fit:e}=o;return B&&e?{objectFit:e}:{}}),Y=g(()=>{const{previewSrcList:e}=o;return Array.isArray(e)&&e.length>0}),re=g(()=>{const{previewSrcList:e,initialIndex:a}=o;let s=a;return a>e.length-1&&(s=0),s}),W=g(()=>o.loading==="eager"?!1:!c&&o.loading==="lazy"||o.lazy),$=()=>{B&&(_.value=!0,x.value=!1,O.value=o.src)};function ie(e){_.value=!1,x.value=!1,u("load",e)}function ce(e){_.value=!1,x.value=!0,u("error",e)}function Z(){sa(h.value,b.value)&&($(),D())}const U=Ye(Z,200,!0);async function q(){var e;if(!B)return;await be();const{scrollContainer:a}=o;Me(a)?b.value=a:ea(a)&&a!==""?b.value=(e=document.querySelector(a))!=null?e:void 0:h.value&&(b.value=Xe(h.value)),b.value&&(X=V(b,"scroll",U),setTimeout(()=>Z(),100))}function D(){!B||!b.value||!U||(X==null||X(),b.value=void 0)}function G(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function F(){Y.value&&(T=V("wheel",G,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",M.value=!0,u("show"))}function J(){T==null||T(),document.body.style.overflow=n,M.value=!1,u("close")}function Q(e){u("switch",e)}return de(()=>o.src,()=>{W.value?(_.value=!0,x.value=!1,D(),q()):$()}),ke(()=>{W.value?q():$()}),(e,a)=>(k(),E("div",{ref_key:"container",ref:h,class:v([t(I).b(),e.$attrs.class]),style:fe(t(oe))},[x.value?ee(e.$slots,"error",{key:0},()=>[f("div",{class:v(t(I).e("error"))},Qe(t(y)("el.image.error")),3)]):(k(),E(ne,{key:1},[O.value!==void 0?(k(),E("img",ve({key:0},t(se),{src:O.value,loading:e.loading,style:t(le),class:t(j),crossorigin:K.value,onClick:F,onLoad:ie,onError:ce}),null,16,pa)):C("v-if",!0),_.value?(k(),E("div",{key:1,class:v(t(I).e("wrapper"))},[ee(e.$slots,"placeholder",{},()=>[f("div",{class:v(t(I).e("placeholder"))},null,2)])],2)):C("v-if",!0)],64)),t(Y)?(k(),E(ne,{key:2},[M.value?(k(),te(t(fa),{key:0,"z-index":e.zIndex,"initial-index":t(re),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:J,onSwitch:Q},{default:p(()=>[e.$slots.viewer?(k(),E("div",ga,[ee(e.$slots,"viewer")])):C("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):C("v-if",!0)],64)):C("v-if",!0)],6))}});var _a=_e(ya,[["__file","image.vue"]]);const ha=he(_a),Ie=l=>(aa("data-v-991a8cb9"),l=l(),ta(),l),ba=Ie(()=>f("div",{class:"h-full w-full flex-row-c-c"},[f("i",{class:"icon","i-solar:menu-dots-bold-duotone":"","opacity-40":""})],-1)),ka=Ie(()=>f("div",{class:"h-full w-full flex-row-c-c"},[f("i",{class:"icon","i-solar:cup-hot-line-duotone":"","opacity-50":""})],-1)),Ia=P({__name:"ElImage",props:{src:{}},setup(l){return w("loading"),(u,o)=>{const n=Le,y=ha,I=De;return k(),te(I,null,{fallback:p(()=>[d(n,ve({message:"",icon:""},u.$attrs),null,16)]),default:p(()=>[d(y,ve(u.$attrs,{src:u.src,loading:"lazy",fit:"cover"}),{placeholder:p(()=>[ba]),error:p(()=>[ka]),_:1},16,["src"])]),_:1})}}}),Ea=Fe(Ia,[["__scopeId","data-v-991a8cb9"]]);export{ha as E,Ea as _,ue as t};
